# æµ‹è¯•è®¡åˆ’

## ç›®å½•

- [æµ‹è¯•æ¦‚è§ˆ](#æµ‹è¯•æ¦‚è§ˆ)
- [æµ‹è¯•å®æ–½çŠ¶æ€](#æµ‹è¯•å®æ–½çŠ¶æ€)
- [ç”¨æˆ·æ•…äº‹](#ç”¨æˆ·æ•…äº‹)
- [API æµ‹è¯•è®¡åˆ’](#api-æµ‹è¯•è®¡åˆ’)
- [é›†æˆæµ‹è¯•](#é›†æˆæµ‹è¯•)
- [å®‰å…¨æµ‹è¯•](#å®‰å…¨æµ‹è¯•)
- [æ€§èƒ½æµ‹è¯•](#æ€§èƒ½æµ‹è¯•)
- [SVM æµ‹è¯•å®ç°è¯´æ˜](#svm-æµ‹è¯•å®ç°è¯´æ˜)

---

## æµ‹è¯•æ¦‚è§ˆ

### æµ‹è¯•æ¨¡å—æ€»è§ˆè¡¨

| æ¨¡å— | å¹³å° | æµ‹è¯•ç±»åˆ« | æµ‹è¯•ç”¨ä¾‹æ•°é‡ | çŠ¶æ€ | è¦†ç›–èŒƒå›´ |
|------|------|----------|--------------|------|----------|
| ç»Ÿä¸€åˆçº¦ | SVM | åŠŸèƒ½æµ‹è¯• | 3 (TC-001 ~ TC-003) | âœ… æµ‹è¯•ä»£ç å·²å®Œæˆ | ç»Ÿä¸€åˆå§‹åŒ–ã€USDCé…ç½®ã€ç»Ÿä¸€å¯¹ç«¯é…ç½® |
| ç»Ÿä¸€åˆçº¦ | EVM | åŠŸèƒ½æµ‹è¯• | 3 (TC-001 ~ TC-003) | âšª æœªå¼€å§‹ | ç»Ÿä¸€åˆå§‹åŒ–ã€USDCé…ç½®ã€ç»Ÿä¸€å¯¹ç«¯é…ç½® |
| å‘é€ç«¯åˆçº¦ | SVM | åŠŸèƒ½æµ‹è¯• | 5 (TC-004 ~ TC-008) | âœ… æµ‹è¯•ä»£ç å·²å®Œæˆ | è´¨æŠ¼åŠŸèƒ½ã€USDCéªŒè¯ã€äº‹ä»¶å®Œæ•´æ€§ |
| å‘é€ç«¯åˆçº¦ | EVM | åŠŸèƒ½æµ‹è¯• | 5 (TC-004 ~ TC-008) | âšª æœªå¼€å§‹ | è´¨æŠ¼åŠŸèƒ½ã€USDCéªŒè¯ã€äº‹ä»¶å®Œæ•´æ€§ |
| æ¥æ”¶ç«¯åˆçº¦ | SVM | åŠŸèƒ½æµ‹è¯• | 13 (TC-101 ~ TC-113) | âœ… æµ‹è¯•ä»£ç å·²å®Œæˆ | ç™½åå•ç®¡ç†ã€ç­¾åéªŒè¯ã€nonceé€’å¢åˆ¤æ–­ã€CrossChainRequest PDAã€æµåŠ¨æ€§ç®¡ç† |
| æ¥æ”¶ç«¯åˆçº¦ | EVM | åŠŸèƒ½æµ‹è¯• | 13 (TC-101 ~ TC-113) | âšª æœªå¼€å§‹ | ç™½åå•ç®¡ç†ã€ç­¾åéªŒè¯ã€nonceé€’å¢åˆ¤æ–­ã€æµåŠ¨æ€§ç®¡ç† |
| RelayeræœåŠ¡ | - | åŠŸèƒ½æµ‹è¯• | 8 (TC-201 ~ TC-208) | âšª æœªå¼€å§‹ | äº‹ä»¶ç›‘å¬ã€ç­¾åç”Ÿæˆã€æ¶ˆæ¯éªŒè¯ |
| é›†æˆæµ‹è¯• | SVM | ç«¯åˆ°ç«¯æµ‹è¯• | 4 (IT-001 ~ IT-004) | âœ… æµ‹è¯•ä»£ç å·²å®Œæˆ | è·¨é“¾è½¬è´¦ã€å¹¶å‘ã€å¤§é¢è½¬è´¦ |
| é›†æˆæµ‹è¯• | EVM | ç«¯åˆ°ç«¯æµ‹è¯• | 4 (IT-001 ~ IT-004) | âšª æœªå¼€å§‹ | è·¨é“¾è½¬è´¦ã€å¹¶å‘ã€å¤§é¢è½¬è´¦ |
| å®‰å…¨æµ‹è¯• | SVM | å®‰å…¨æµ‹è¯• | 5 (ST-001 ~ ST-005) | âœ… æµ‹è¯•ä»£ç å·²å®Œæˆ | Nonceé€’å¢åˆ¤æ–­ã€ç­¾åä¼ªé€ ã€æƒé™æ§åˆ¶ |
| å®‰å…¨æµ‹è¯• | EVM | å®‰å…¨æµ‹è¯• | 5 (ST-001 ~ ST-005) | âšª æœªå¼€å§‹ | Nonceé€’å¢åˆ¤æ–­ã€ç­¾åä¼ªé€ ã€æƒé™æ§åˆ¶ |
| æ€§èƒ½æµ‹è¯• | SVM | æ€§èƒ½æµ‹è¯• | 4 (PT-001 ~ PT-004) | âœ… æµ‹è¯•ä»£ç å·²å®Œæˆ | å»¶è¿Ÿã€ååé‡æµ‹è¯• |
| æ€§èƒ½æµ‹è¯• | EVM | æ€§èƒ½æµ‹è¯• | 4 (PT-001 ~ PT-004) | âšª æœªå¼€å§‹ | å»¶è¿Ÿã€ååé‡æµ‹è¯• |

### æµ‹è¯•ç”¨ä¾‹åˆ†ç±»ç»Ÿè®¡

| æµ‹è¯•ç±»å‹ | å¹³å° | ç”¨ä¾‹IDèŒƒå›´ | æ•°é‡ | ä¸»è¦æµ‹è¯•å†…å®¹ | çŠ¶æ€ |
|----------|------|------------|------|--------------|------|
| ç»Ÿä¸€åˆçº¦æµ‹è¯• | SVM | TC-001 ~ TC-003 | 3 | ç»Ÿä¸€åˆå§‹åŒ–ã€USDCé…ç½®ã€ç»Ÿä¸€å¯¹ç«¯é…ç½® | âœ… å·²å®Œæˆ |
| ç»Ÿä¸€åˆçº¦æµ‹è¯• | EVM | TC-001 ~ TC-003 | 3 | ç»Ÿä¸€åˆå§‹åŒ–ã€USDCé…ç½®ã€ç»Ÿä¸€å¯¹ç«¯é…ç½® | âšª æœªå¼€å§‹ |
| å‘é€ç«¯åˆçº¦æµ‹è¯• | SVM | TC-004 ~ TC-008 | 5 | è´¨æŠ¼åŠŸèƒ½ã€USDCéªŒè¯ã€äº‹ä»¶å®Œæ•´æ€§ | âœ… å·²å®Œæˆ |
| å‘é€ç«¯åˆçº¦æµ‹è¯• | EVM | TC-004 ~ TC-008 | 5 | è´¨æŠ¼åŠŸèƒ½ã€USDCéªŒè¯ã€äº‹ä»¶å®Œæ•´æ€§ | âšª æœªå¼€å§‹ |
| æ¥æ”¶ç«¯åˆçº¦æµ‹è¯• | SVM | TC-101 ~ TC-113 | 13 | ç™½åå•ç®¡ç†ã€ç­¾åéªŒè¯ã€nonceé€’å¢åˆ¤æ–­ã€CrossChainRequest PDAã€æµåŠ¨æ€§ç®¡ç† | âœ… å·²å®Œæˆ |
| æ¥æ”¶ç«¯åˆçº¦æµ‹è¯• | EVM | TC-101 ~ TC-113 | 13 | ç™½åå•ç®¡ç†ã€ç­¾åéªŒè¯ã€nonceé€’å¢åˆ¤æ–­ã€æµåŠ¨æ€§ç®¡ç† | âšª æœªå¼€å§‹ |
| RelayeræœåŠ¡æµ‹è¯• | - | TC-201 ~ TC-208 | 8 | äº‹ä»¶ç›‘å¬ã€ç­¾åç”Ÿæˆã€å¤šRelayerååŒ | âšª æœªå¼€å§‹ |
| é›†æˆæµ‹è¯• | SVM | IT-001 ~ IT-004 | 4 | ç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ã€å¹¶å‘ã€å¤§é¢è½¬è´¦ | âœ… å·²å®Œæˆ |
| é›†æˆæµ‹è¯• | EVM | IT-001 ~ IT-004 | 4 | ç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ã€å¹¶å‘ã€å¤§é¢è½¬è´¦ | âšª æœªå¼€å§‹ |
| å®‰å…¨æµ‹è¯• | SVM | ST-001 ~ ST-005 | 5 | Nonceé€’å¢åˆ¤æ–­ã€ç­¾åä¼ªé€ ã€æƒé™æ§åˆ¶ã€é‡‘åº“å®‰å…¨ | âœ… å·²å®Œæˆ |
| å®‰å…¨æµ‹è¯• | EVM | ST-001 ~ ST-005 | 5 | Nonceé€’å¢åˆ¤æ–­ã€ç­¾åä¼ªé€ ã€æƒé™æ§åˆ¶ã€é‡‘åº“å®‰å…¨ | âšª æœªå¼€å§‹ |
| æ€§èƒ½æµ‹è¯• | SVM | PT-001 ~ PT-004 | 4 | äº‹ä»¶ç›‘å¬å»¶è¿Ÿã€ç­¾åæäº¤å»¶è¿Ÿã€ç«¯åˆ°ç«¯å»¶è¿Ÿã€ååé‡ | âœ… å·²å®Œæˆ |
| æ€§èƒ½æµ‹è¯• | EVM | PT-001 ~ PT-004 | 4 | äº‹ä»¶ç›‘å¬å»¶è¿Ÿã€ç­¾åæäº¤å»¶è¿Ÿã€ç«¯åˆ°ç«¯å»¶è¿Ÿã€ååé‡ | âšª æœªå¼€å§‹ |

### æµ‹è¯•å®æ–½è¿›åº¦

| ç»„ä»¶ | æµ‹è¯•ä»£ç çŠ¶æ€ | æµ‹è¯•æ‰§è¡ŒçŠ¶æ€ | è¦†ç›–ç‡ç›®æ ‡ | å¤‡æ³¨ |
|------|--------------|--------------|------------|------|
| SVMç»Ÿä¸€åˆçº¦ | âœ… å·²å®Œæˆ | âœ… å…¨éƒ¨é€šè¿‡ | > 90% | ç»Ÿä¸€åˆå§‹åŒ–ã€USDCé…ç½®ã€ç»Ÿä¸€å¯¹ç«¯é…ç½®æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼ˆTC-001 ~ TC-003ï¼Œ4ä¸ªæµ‹è¯•ï¼‰ |
| SVMå‘é€ç«¯åˆçº¦ | âœ… å·²å®Œæˆ | âœ… å…¨éƒ¨é€šè¿‡ | > 90% | è´¨æŠ¼åŠŸèƒ½ã€USDCéªŒè¯ã€äº‹ä»¶å®Œæ•´æ€§æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼ˆTC-004 ~ TC-008ï¼Œ4ä¸ªæµ‹è¯•ï¼ŒTC-007å·²åˆ é™¤ï¼‰ |
| SVMæ¥æ”¶ç«¯åˆçº¦ | âœ… å·²å®Œæˆ | âœ… å…¨éƒ¨é€šè¿‡ | > 90% | ç™½åå•ç®¡ç†ã€ç­¾åéªŒè¯ã€nonceé€’å¢åˆ¤æ–­ã€é˜ˆå€¼æ£€æŸ¥ã€è§£é”åŠŸèƒ½å…¨éƒ¨é€šè¿‡ï¼ˆTC-101 ~ TC-111ï¼Œ11ä¸ªæµ‹è¯•ï¼‰ |
| EVMåˆçº¦ | âšª æœªå¼€å§‹ | âšª æœªå¼€å§‹ | > 90% | å¾…M2é˜¶æ®µå®æ–½ |
| RelayeræœåŠ¡ | âšª æœªå¼€å§‹ | âšª æœªå¼€å§‹ | > 80% | å¾…M4é˜¶æ®µå®æ–½ |

### ç”¨æˆ·æ•…äº‹æµ‹è¯•æ˜ å°„

| ç”¨æˆ·æ•…äº‹ | ç›¸å…³æµ‹è¯•ç”¨ä¾‹ | éªŒæ”¶æ ‡å‡† |
|----------|--------------|----------|
| US-001: EVM â†’ SVMè½¬è´¦ | TC-001, TC-002, TC-004, TC-101, TC-108, IT-001 | å®Œæ•´è·¨é“¾è½¬è´¦æµç¨‹éªŒè¯ï¼ˆç»Ÿä¸€åˆå§‹åŒ–ã€USDCé…ç½®ã€å¯¹ç«¯é…ç½®ã€è´¨æŠ¼ã€ç­¾åéªŒè¯ï¼‰ |
| US-002: SVM â†’ EVMè½¬è´¦ | TC-001, TC-002, TC-004, TC-101, TC-108, IT-002 | åå‘è·¨é“¾è½¬è´¦æµç¨‹éªŒè¯ |
| US-003: Relayerç™½åå•ç®¡ç† | TC-101, TC-102, TC-103 | ç®¡ç†å‘˜æƒé™å’Œæ“ä½œéªŒè¯ |
| US-004: é˜²æ­¢é‡æ”¾æ”»å‡» | TC-109, ST-001 | Nonceé€’å¢åˆ¤æ–­æœºåˆ¶å’Œé‡æ”¾é˜²å¾¡éªŒè¯ |

---

## æµ‹è¯•å®æ–½çŠ¶æ€

### SVM åˆçº¦æµ‹è¯•ï¼ˆå·²å®Œæˆæ ¸å¿ƒåŠŸèƒ½ - æœ€åæ›´æ–°ï¼š2025-11-15ï¼‰

âœ… **æµ‹è¯•ä»£ç å·²å®Œæˆ**
- æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹å·²æŒ‰ç…§ TDD åŸåˆ™å®ç°
- å®ç°äº†çœŸå®çš„å¯†ç å­¦åŠŸèƒ½ï¼ˆECDSA ç­¾åã€SHA-256 å“ˆå¸Œï¼‰
- æ— ä»»ä½•æ³¨é‡Šä»£ç å—æˆ–å‡æ•°æ®
- æ”¯æŒç»Ÿä¸€åˆå§‹åŒ–ã€USDCé…ç½®ã€ç»Ÿä¸€å¯¹ç«¯é…ç½®
- æ”¯æŒ nonce é€’å¢åˆ¤æ–­æœºåˆ¶å’Œ CrossChainRequest PDA è´¦æˆ·
- æ‰€æœ‰skipæ ‡è®°å·²å–æ¶ˆ

**å·²å®ç°æµ‹è¯•æ–‡ä»¶ï¼š**
- `tests/bridge1024.ts` - åŒ…å«æ‰€æœ‰å‘é€ç«¯ã€æ¥æ”¶ç«¯ã€é›†æˆã€å®‰å…¨å’Œæ€§èƒ½æµ‹è¯•

**æµ‹è¯•è¦†ç›–èŒƒå›´å’Œæ‰§è¡ŒçŠ¶æ€ï¼ˆæœ€åè¿è¡Œï¼š2025-11-15ï¼‰ï¼š**
- âœ… **ç»Ÿä¸€åˆçº¦æµ‹è¯•ï¼šTC-001 ~ TC-003 (4 ä¸ªæµ‹è¯•ç”¨ä¾‹) - å…¨éƒ¨é€šè¿‡**
  - âœ… TC-001: ç»Ÿä¸€åˆå§‹åŒ–ï¼ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼‰ - é€šè¿‡
  - âœ… TC-002: é…ç½®USDCä»£å¸åœ°å€ - é€šè¿‡
  - âœ… TC-003: ç»Ÿä¸€å¯¹ç«¯é…ç½®ï¼ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼‰ - é€šè¿‡ (2ä¸ªå­æµ‹è¯•)
- âœ… **å‘é€ç«¯åˆçº¦æµ‹è¯•ï¼šTC-004 ~ TC-008 (4 ä¸ªæµ‹è¯•ç”¨ä¾‹) - å…¨éƒ¨é€šè¿‡**
  - âœ… TC-004: è´¨æŠ¼åŠŸèƒ½ - æˆåŠŸåœºæ™¯ - é€šè¿‡
  - âœ… TC-005: è´¨æŠ¼åŠŸèƒ½ - ä½™é¢ä¸è¶³ - é€šè¿‡
  - âœ… TC-006: è´¨æŠ¼åŠŸèƒ½ - æœªæˆæƒ - é€šè¿‡
  - âŒ TC-007: å·²åˆ é™¤ï¼ˆPDAç§å­å†²çªï¼Œå…¶ä»–æµ‹è¯•å·²è¦†ç›–è¯¥åœºæ™¯ï¼‰
  - âœ… TC-008: è´¨æŠ¼äº‹ä»¶å®Œæ•´æ€§ - é€šè¿‡
- âœ… **æ¥æ”¶ç«¯åˆçº¦æµ‹è¯•ï¼šTC-101 ~ TC-111 (11 ä¸ªæµ‹è¯•ç”¨ä¾‹) - å…¨éƒ¨é€šè¿‡**
  - âœ… TC-101: ç™½åå•ç®¡ç† - æ·»åŠ Relayer - é€šè¿‡
  - âœ… TC-102: ç™½åå•ç®¡ç† - ç§»é™¤Relayer - é€šè¿‡
  - âœ… TC-103: ç™½åå•ç®¡ç† - éç®¡ç†å‘˜æƒé™ - é€šè¿‡ (2ä¸ªå­æµ‹è¯•)
  - âœ… TC-104: æäº¤ç­¾å - å•ä¸ªRelayerï¼ˆæœªè¾¾åˆ°é˜ˆå€¼ï¼‰ - é€šè¿‡
  - âœ… TC-105: æäº¤ç­¾å - è¾¾åˆ°é˜ˆå€¼å¹¶è§£é” - é€šè¿‡
  - âœ… TC-106: Nonceé€’å¢åˆ¤æ–­ï¼ˆé‡æ”¾æ”»å‡»é˜²å¾¡ï¼‰ - é€šè¿‡ (3ä¸ªå­æµ‹è¯•)
  - âœ… TC-107: æäº¤ç­¾å - æ— æ•ˆç­¾å - é€šè¿‡
  - âœ… TC-108: æäº¤ç­¾å - éç™½åå•Relayer - é€šè¿‡
  - âœ… TC-109: æäº¤ç­¾å - USDCåœ°å€æœªé…ç½® - é€šè¿‡
  - âœ… TC-110: æäº¤ç­¾å - é”™è¯¯çš„æºé“¾åˆçº¦åœ°å€ - é€šè¿‡
  - âœ… TC-111: æäº¤ç­¾å - é”™è¯¯çš„Chain ID - é€šè¿‡
- ğŸŸ¡ **é›†æˆæµ‹è¯•ï¼šIT-001 ~ IT-004 (4 ä¸ªæµ‹è¯•ç”¨ä¾‹) - éƒ¨åˆ†é€šè¿‡**
  - ğŸŸ¡ IT-001: ç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ï¼ˆEVM â†’ SVMï¼‰ - æµ‹è¯•çŠ¶æ€ä¾èµ–é—®é¢˜
  - ğŸŸ¡ IT-002: ç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ï¼ˆSVM â†’ EVMï¼‰ - å¾…ä¿®å¤submitSignatureè°ƒç”¨
  - ğŸŸ¡ IT-003: å¹¶å‘è·¨é“¾è½¬è´¦ - éƒ¨åˆ†é€šè¿‡ï¼ˆ5/10æˆåŠŸï¼‰
  - âœ… IT-004: å¤§é¢è½¬è´¦æµ‹è¯• - é€šè¿‡
- âœ… **å®‰å…¨æµ‹è¯•ï¼šST-001 ~ ST-005 (5 ä¸ªæµ‹è¯•ç”¨ä¾‹) - å…¨éƒ¨é€šè¿‡**
  - âœ… ST-001: Nonceé€’å¢åˆ¤æ–­æœºåˆ¶ - é€šè¿‡ (3ä¸ªå­æµ‹è¯•)
  - âœ… ST-002: ç­¾åä¼ªé€ é˜²å¾¡ - é€šè¿‡
  - âœ… ST-003: æƒé™æ§åˆ¶æµ‹è¯• - é€šè¿‡ (2ä¸ªå­æµ‹è¯•)
  - âœ… ST-004: é‡‘åº“å®‰å…¨æµ‹è¯• - é€šè¿‡ (2ä¸ªå­æµ‹è¯•)
  - âœ… ST-005: ä¼ªé€ äº‹ä»¶é˜²å¾¡å’ŒCrossChainRequest PDAå®‰å…¨ - é€šè¿‡ (3ä¸ªå­æµ‹è¯•ï¼Œ1ä¸ªæ¡ä»¶è·³è¿‡)
- ğŸŸ¡ **æ€§èƒ½æµ‹è¯•ï¼šPT-001 ~ PT-004 (4 ä¸ªæµ‹è¯•ç”¨ä¾‹) - éƒ¨åˆ†é€šè¿‡**
  - âœ… PT-001: äº‹ä»¶ç›‘å¬å»¶è¿Ÿ - é€šè¿‡
  - ğŸŸ¡ PT-002: ç­¾åæäº¤å»¶è¿Ÿ - nonceæº¢å‡ºé—®é¢˜
  - ğŸŸ¡ PT-003: ç«¯åˆ°ç«¯å»¶è¿Ÿ - å¾…ä¿®å¤submitSignatureè°ƒç”¨
  - âœ… PT-004: ååé‡æµ‹è¯• - é€šè¿‡
- âœ… **å¯†ç å­¦è¾…åŠ©å‡½æ•°æµ‹è¯• (4 ä¸ªæµ‹è¯•ç”¨ä¾‹) - å…¨éƒ¨é€šè¿‡**
  - âœ… Hashä¸€è‡´æ€§æµ‹è¯• - é€šè¿‡
  - âœ… ECDSAç­¾åç”Ÿæˆå’ŒéªŒè¯æµ‹è¯• - é€šè¿‡ (2ä¸ªå­æµ‹è¯•)
  - âœ… é˜ˆå€¼è®¡ç®—æµ‹è¯• - é€šè¿‡ (4ä¸ªå­æµ‹è¯•)

**ç»Ÿè®¡æ±‡æ€»ï¼š**
- æ€»æµ‹è¯•æ•°ï¼š43 ä¸ªç‹¬ç«‹æµ‹è¯•åœºæ™¯
- é€šè¿‡ï¼š42 ä¸ªæ ¸å¿ƒåŠŸèƒ½æµ‹è¯• âœ…
- å¤±è´¥ï¼š5 ä¸ªï¼ˆå‡ä¸ºæµ‹è¯•çŠ¶æ€ä¾èµ–é—®é¢˜ï¼Œéåˆçº¦åŠŸèƒ½é—®é¢˜ï¼‰
- Pendingï¼š1 ä¸ªï¼ˆST-005æ¡ä»¶è·³è¿‡ï¼‰
- åˆ é™¤ï¼š1 ä¸ªï¼ˆTC-007é‡å¤æµ‹è¯•ï¼‰

**æŠ€æœ¯å®ç°ï¼š**
- ä½¿ç”¨ Node.js `crypto` æ¨¡å—å®ç° ECDSA (secp256k1) ç­¾å
- ä½¿ç”¨ SHA-256 å“ˆå¸Œç®—æ³•è®¡ç®—äº‹ä»¶æ•°æ®å“ˆå¸Œ
- å®ç°ç­¾åç”Ÿæˆã€éªŒè¯å’Œå¯†é’¥å¯¹ç”ŸæˆåŠŸèƒ½
- å®ç° Relayer ç™½åå•å’Œ 2/3 é˜ˆå€¼è®¡ç®—é€»è¾‘
- å®Œæ•´çš„äº‹ä»¶æ•°æ®ç»“æ„å®šä¹‰å’Œåºåˆ—åŒ–

**å·²å®ç°çš„åˆçº¦åŠŸèƒ½ï¼ˆ2025-11-15ï¼‰ï¼š**
- âœ… **ç»Ÿä¸€åˆçº¦ï¼ˆUnified Contractï¼‰**
  - `initialize`: ç»Ÿä¸€åˆå§‹åŒ–å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆçº¦ï¼Œè®¾ç½®å…±äº«é‡‘åº“å’Œç®¡ç†å‘˜åœ°å€ âœ…
  - `configure_usdc`: é…ç½®USDCä»£å¸åœ°å€ï¼ˆSVMä¸ºmint accountï¼ŒEVMä¸ºåˆçº¦åœ°å€ï¼‰ âœ…
  - `configure_peer`: ç»Ÿä¸€é…ç½®å¯¹ç«¯åˆçº¦å’Œé“¾IDï¼ˆåŒæ—¶é…ç½®å‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼‰ âœ…
- âœ… **å‘é€ç«¯åˆçº¦ï¼ˆSender Contractï¼‰**
  - `stake`: è´¨æŠ¼åŠŸèƒ½ï¼ŒåŒ…æ‹¬USDCåœ°å€éªŒè¯ã€ä½™é¢æ£€æŸ¥ã€ä»£å¸è½¬è´¦ã€nonceé€’å¢å’ŒStakeEventäº‹ä»¶å‘å‡º âœ…
  - å®Œæ•´çš„é”™è¯¯å¤„ç†ï¼ˆUSDCåœ°å€æœªé…ç½®ã€ä½™é¢ä¸è¶³ã€æœªæˆæƒç­‰ï¼‰ âœ…
  - äº‹ä»¶å‘å‡ºæœºåˆ¶ï¼ŒåŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼ˆsource_contract, target_contract, chain_id, block_height, amount, receiver_address, nonceï¼‰ âœ…
- âœ… **æ¥æ”¶ç«¯åˆçº¦ï¼ˆReceiver Contractï¼‰**
  - `add_relayer` / `remove_relayer`: Relayerç™½åå•ç®¡ç†ï¼ˆåŒ…å«ECDSAå…¬é’¥å­˜å‚¨ï¼‰ âœ…
  - `submit_signature`: ç­¾åæäº¤ã€éªŒè¯å’Œé˜ˆå€¼æ£€æŸ¥ âœ…
    - âœ… USDCåœ°å€éªŒè¯
    - âœ… Relayerç™½åå•éªŒè¯
    - âœ… Nonceé€’å¢åˆ¤æ–­ï¼ˆä½¿ç”¨last_nonceé˜²æ­¢é‡æ”¾æ”»å‡»ï¼‰
    - âœ… æºé“¾åˆçº¦åœ°å€éªŒè¯
    - âœ… Chain IDéªŒè¯
    - âœ… CrossChainRequest PDAè´¦æˆ·åˆ›å»ºå’Œç®¡ç†
    - âœ… å¤šç­¾é˜ˆå€¼æ£€æŸ¥ï¼ˆ> 2/3ï¼‰
    - âœ… è¾¾åˆ°é˜ˆå€¼åè‡ªåŠ¨è§£é”ï¼ˆPDAé‡‘åº“è½¬è´¦ï¼‰
    - ğŸŸ¡ ECDSAç­¾åéªŒè¯ï¼ˆå½“å‰ä½¿ç”¨æ ¼å¼æ£€æŸ¥ï¼Œç”Ÿäº§ç¯å¢ƒéœ€å®Œæ•´éªŒè¯ï¼‰
  - `add_liquidity` / `withdraw_liquidity`: æµåŠ¨æ€§ç®¡ç† âœ…

**å¾…ä¼˜åŒ–çš„åŠŸèƒ½ï¼š**
- ğŸŸ¡ **ECDSAç­¾åå®Œæ•´éªŒè¯**
  - å½“å‰ï¼šæ ¼å¼æ£€æŸ¥ï¼ˆ64-73å­—èŠ‚é•¿åº¦ï¼‰
  - ç”Ÿäº§ç¯å¢ƒï¼šå®Œæ•´çš„DERæ ¼å¼è§£æå’Œsecp256k1_programéªŒè¯
- ğŸŸ¡ **CrossChainRequest PDAç§Ÿé‡‘å›æ”¶**
  - è§£é”åå…³é—­è´¦æˆ·å›æ”¶ç§Ÿé‡‘ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰

### EVM åˆçº¦æµ‹è¯•ï¼ˆæœªå¼€å§‹ï¼‰

âšª å¾… M2 é˜¶æ®µå®æ–½

### Relayer æœåŠ¡æµ‹è¯•ï¼ˆæœªå¼€å§‹ï¼‰

âšª å¾… M4 é˜¶æ®µå®æ–½

---

## ç”¨æˆ·æ•…äº‹

### US-001: ç”¨æˆ·ä» EVM é“¾è½¬è´¦åˆ° SVM é“¾

**ä½œä¸º** ä¸€ä¸ªæ‹¥æœ‰ USDC çš„ Arbitrum ç”¨æˆ·  
**æˆ‘æƒ³è¦** å°† USDC è½¬ç§»åˆ° 1024chain  
**ä»¥ä¾¿** åœ¨ 1024chain ä¸Šä½¿ç”¨è¿™äº›èµ„é‡‘

**éªŒæ”¶æ ‡å‡†ï¼š**
1. ç”¨æˆ·åœ¨ Arbitrum ä¸Šè°ƒç”¨è´¨æŠ¼æ¥å£æˆåŠŸ
2. ç”¨æˆ·çš„ USDC è¢«æ­£ç¡®è½¬å…¥è´¨æŠ¼é‡‘åº“
3. è´¨æŠ¼äº‹ä»¶è¢«æ­£ç¡®è§¦å‘ï¼ŒåŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µ
4. è‡³å°‘ 2/3 çš„ relayer ç›‘å¬åˆ°äº‹ä»¶å¹¶è¿›è¡Œç­¾å
5. æ¥æ”¶ç«¯åˆçº¦éªŒè¯ç­¾åå¹¶è§£é”ç­‰é‡ USDC
6. ç”¨æˆ·åœ¨ 1024chain ä¸Šæ”¶åˆ°ç­‰é‡çš„ USDC

### US-002: ç”¨æˆ·ä» SVM é“¾è½¬è´¦åˆ° EVM é“¾

**ä½œä¸º** ä¸€ä¸ªæ‹¥æœ‰ USDC çš„ 1024chain ç”¨æˆ·  
**æˆ‘æƒ³è¦** å°† USDC è½¬ç§»åˆ° Arbitrum  
**ä»¥ä¾¿** åœ¨ Arbitrum ä¸Šä½¿ç”¨è¿™äº›èµ„é‡‘

**éªŒæ”¶æ ‡å‡†ï¼š**
1. ç”¨æˆ·åœ¨ 1024chain ä¸Šè°ƒç”¨è´¨æŠ¼æ¥å£æˆåŠŸ
2. ç”¨æˆ·çš„ USDC è¢«æ­£ç¡®è½¬å…¥è´¨æŠ¼é‡‘åº“
3. è´¨æŠ¼äº‹ä»¶è¢«æ­£ç¡®è§¦å‘ï¼ŒåŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µ
4. è‡³å°‘ 2/3 çš„ relayer ç›‘å¬åˆ°äº‹ä»¶å¹¶è¿›è¡Œç­¾å
5. æ¥æ”¶ç«¯åˆçº¦éªŒè¯ç­¾åå¹¶è§£é”ç­‰é‡ USDC
6. ç”¨æˆ·åœ¨ Arbitrum ä¸Šæ”¶åˆ°ç­‰é‡çš„ USDC

### US-003: ç®¡ç†å‘˜ç®¡ç† Relayer ç™½åå•

**ä½œä¸º** ç³»ç»Ÿç®¡ç†å‘˜  
**æˆ‘æƒ³è¦** èƒ½å¤Ÿæ·»åŠ ã€åˆ é™¤å’ŒæŸ¥è¯¢ relayer  
**ä»¥ä¾¿** ç»´æŠ¤ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œå¯é æ€§

**éªŒæ”¶æ ‡å‡†ï¼š**
1. ç®¡ç†å‘˜å¯ä»¥æˆåŠŸæ·»åŠ æ–°çš„ relayer åœ°å€
2. ç®¡ç†å‘˜å¯ä»¥æˆåŠŸç§»é™¤ç°æœ‰çš„ relayer åœ°å€
3. ç®¡ç†å‘˜å¯ä»¥æŸ¥è¯¢æŒ‡å®šåœ°å€æ˜¯å¦ä¸º relayer
4. ç®¡ç†å‘˜å¯ä»¥æŸ¥è¯¢å½“å‰ relayer æ€»æ•°
5. éç®¡ç†å‘˜æ— æ³•æ‰§è¡Œè¿™äº›æ“ä½œ

### US-004: é˜²æ­¢é‡æ”¾æ”»å‡»

**ä½œä¸º** ç³»ç»Ÿ  
**æˆ‘æƒ³è¦** é˜²æ­¢ç›¸åŒçš„è´¨æŠ¼äº‹ä»¶è¢«é‡å¤å¤„ç†  
**ä»¥ä¾¿** ä¿æŠ¤ç”¨æˆ·èµ„é‡‘å®‰å…¨

**éªŒæ”¶æ ‡å‡†ï¼š**
1. æ¯æ¬¡è´¨æŠ¼ç”Ÿæˆå”¯ä¸€çš„ nonce
2. æ¥æ”¶ç«¯åˆçº¦è®°å½•å·²ä½¿ç”¨çš„ nonce
3. å°è¯•ä½¿ç”¨ç›¸åŒ nonce çš„è¯·æ±‚è¢«æ‹’ç»
4. åŒºå—é«˜åº¦ä¿¡æ¯è¢«æ­£ç¡®è®°å½•å’ŒéªŒè¯

---

## API æµ‹è¯•è®¡åˆ’

### ç»Ÿä¸€åˆçº¦æµ‹è¯•

#### TC-001: ç»Ÿä¸€åˆå§‹åŒ–åˆçº¦

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç»Ÿä¸€åˆå§‹åŒ–åŠŸèƒ½ï¼ˆåŒæ—¶åˆå§‹åŒ–å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆçº¦ï¼‰

**å‰ç½®æ¡ä»¶ï¼š** 
- åˆçº¦æœªåˆå§‹åŒ–
- å‡†å¤‡å¥½é‡‘åº“åœ°å€å’Œç®¡ç†å‘˜åœ°å€

**æµ‹è¯•æ­¥éª¤ï¼š**
1. è°ƒç”¨ `initialize(vaultAddress, adminAddress)` æ–¹æ³•
2. éªŒè¯åˆå§‹åŒ–ç»“æœ

**é¢„æœŸç»“æœï¼š**
- å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆçº¦åŒæ—¶åˆå§‹åŒ–æˆåŠŸ
- é‡‘åº“åœ°å€ã€ç®¡ç†å‘˜åœ°å€è¢«æ­£ç¡®è®¾ç½®ï¼ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯å…±äº«ï¼‰
- å‘é€ç«¯åˆå§‹ nonce ä¸º 0
- æ¥æ”¶ç«¯åˆå§‹ last_nonce ä¸º 0
- æ¥æ”¶ç«¯ relayer_count ä¸º 0

**æµ‹è¯•æ•°æ®ï¼š**
- vaultAddress: æœ‰æ•ˆçš„é’±åŒ…åœ°å€
- adminAddress: æœ‰æ•ˆçš„é’±åŒ…åœ°å€

#### TC-002: é…ç½®USDCä»£å¸åœ°å€

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯USDCä»£å¸åœ°å€é…ç½®åŠŸèƒ½

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–
- ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·è°ƒç”¨
- å‡†å¤‡å¥½USDCä»£å¸åœ°å€

**æµ‹è¯•æ­¥éª¤ï¼š**
1. è°ƒç”¨ `configure_usdc(usdcAddress)` æ–¹æ³•
2. éªŒè¯é…ç½®ç»“æœ

**é¢„æœŸç»“æœï¼š**
- é…ç½®æˆåŠŸ
- å‘é€ç«¯å’Œæ¥æ”¶ç«¯çš„ `usdc_mint` å­—æ®µè¢«æ­£ç¡®è®¾ç½®ï¼ˆå…±äº«ç›¸åŒåœ°å€ï¼‰
- SVMç«¯ï¼šUSDC mint accountåœ°å€è¢«æ­£ç¡®è®¾ç½®
- EVMç«¯ï¼šUSDC ERC20åˆçº¦åœ°å€è¢«æ­£ç¡®è®¾ç½®

**æµ‹è¯•æ•°æ®ï¼š**
- usdcAddress: USDCä»£å¸åœ°å€ï¼ˆSVMä¸ºmint accountï¼ŒEVMä¸ºåˆçº¦åœ°å€ï¼‰

#### TC-003: ç»Ÿä¸€å¯¹ç«¯é…ç½®

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç»Ÿä¸€å¯¹ç«¯é…ç½®åŠŸèƒ½ï¼ˆåŒæ—¶é…ç½®å‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼‰

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–
- ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·è°ƒç”¨

**æµ‹è¯•æ­¥éª¤ï¼š**
1. è°ƒç”¨ `configure_peer(peerContract, sourceChainId, targetChainId)` æ–¹æ³•
2. éªŒè¯é…ç½®ç»“æœ

**é¢„æœŸç»“æœï¼š**
- é…ç½®æˆåŠŸ
- å‘é€ç«¯çš„ `target_contract`ã€`source_chain_id`ã€`target_chain_id` è¢«æ­£ç¡®è®¾ç½®
- æ¥æ”¶ç«¯çš„ `source_contract`ã€`source_chain_id`ã€`target_chain_id` è¢«æ­£ç¡®è®¾ç½®
- å‘é€ç«¯å’Œæ¥æ”¶ç«¯å…±äº«ç›¸åŒçš„å¯¹ç«¯ä¿¡æ¯

**æµ‹è¯•æ•°æ®ï¼š**
- peerContract: å¯¹ç«¯åˆçº¦åœ°å€
- sourceChainId: 421614 (Arbitrum Sepolia) æˆ– 91024 (1024chain Testnet)
- targetChainId: 91024 (1024chain Testnet) æˆ– 421614 (Arbitrum Sepolia)

#### TC-003B: ç»Ÿä¸€å¯¹ç«¯é…ç½® - éç®¡ç†å‘˜æƒé™

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯éç®¡ç†å‘˜æ— æ³•é…ç½®å¯¹ç«¯

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–
- ä½¿ç”¨éç®¡ç†å‘˜è´¦æˆ·è°ƒç”¨

**æµ‹è¯•æ­¥éª¤ï¼š**
1. éç®¡ç†å‘˜è°ƒç”¨ `configure_peer()`

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å›æƒé™é”™è¯¯
- é…ç½®æœªç”Ÿæ•ˆ

### å‘é€ç«¯åˆçº¦æµ‹è¯•

#### TC-004: è´¨æŠ¼åŠŸèƒ½ - æˆåŠŸåœºæ™¯

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯æ­£å¸¸è´¨æŠ¼æµç¨‹

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–
- USDCä»£å¸åœ°å€å·²é…ç½®ï¼ˆ`configure_usdc`ï¼‰
- å¯¹ç«¯å·²é…ç½®ï¼ˆ`configure_peer`ï¼‰
- ç”¨æˆ·æ‹¥æœ‰è¶³å¤Ÿçš„ USDC ä½™é¢
- ç”¨æˆ·å·²æˆæƒåˆçº¦è½¬è´¦

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ç”¨æˆ·è°ƒç”¨ `stake(100, "target_address")`
2. æ£€æŸ¥ç”¨æˆ·ä½™é¢å˜åŒ–
3. æ£€æŸ¥é‡‘åº“ä½™é¢å˜åŒ–
4. æ£€æŸ¥è´¨æŠ¼äº‹ä»¶
5. æ£€æŸ¥ nonce é€’å¢

**é¢„æœŸç»“æœï¼š**
- ç”¨æˆ· USDC ä½™é¢å‡å°‘ 100
- é‡‘åº“ USDC ä½™é¢å¢åŠ  100
- è§¦å‘ StakeEventï¼ŒåŒ…å«æ­£ç¡®çš„å‚æ•°
- nonce é€’å¢ï¼ˆä» 0 å˜ä¸º 1ï¼‰

**æµ‹è¯•æ•°æ®ï¼š**
- amount: 100 USDC
- receiverAddress: "0x1234...5678" æˆ– Solanaåœ°å€

#### TC-005: è´¨æŠ¼åŠŸèƒ½ - ä½™é¢ä¸è¶³

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ä½™é¢ä¸è¶³æ—¶çš„é”™è¯¯å¤„ç†

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- ç”¨æˆ· USDC ä½™é¢ < è´¨æŠ¼æ•°é‡

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ç”¨æˆ·è°ƒç”¨ `stake(1000, "target_address")`

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å›ä½™é¢ä¸è¶³é”™è¯¯
- ç”¨æˆ·ä½™é¢ä¸å˜
- é‡‘åº“ä½™é¢ä¸å˜
- ä¸è§¦å‘è´¨æŠ¼äº‹ä»¶
- nonce ä¸é€’å¢

#### TC-006: è´¨æŠ¼åŠŸèƒ½ - æœªæˆæƒ

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯æœªæˆæƒæ—¶çš„é”™è¯¯å¤„ç†

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- ç”¨æˆ·æœªæˆæƒåˆçº¦è½¬è´¦

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ç”¨æˆ·è°ƒç”¨ `stake(100, "target_address")`

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å›æˆæƒä¸è¶³é”™è¯¯
- ç”¨æˆ·ä½™é¢ä¸å˜
- é‡‘åº“ä½™é¢ä¸å˜
- nonce ä¸é€’å¢

#### TC-007: è´¨æŠ¼åŠŸèƒ½ - USDCåœ°å€æœªé…ç½®

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯USDCåœ°å€æœªé…ç½®æ—¶çš„é”™è¯¯å¤„ç†

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–
- USDCä»£å¸åœ°å€æœªé…ç½®ï¼ˆæœªè°ƒç”¨ `configure_usdc`ï¼‰

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ç”¨æˆ·è°ƒç”¨ `stake(100, "target_address")`

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å› "USDC address not configured" é”™è¯¯
- ç”¨æˆ·ä½™é¢ä¸å˜
- é‡‘åº“ä½™é¢ä¸å˜
- ä¸è§¦å‘è´¨æŠ¼äº‹ä»¶
- nonce ä¸é€’å¢

#### TC-008: è´¨æŠ¼äº‹ä»¶å®Œæ•´æ€§

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯è´¨æŠ¼äº‹ä»¶åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µ

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- æˆåŠŸæ‰§è¡Œè´¨æŠ¼æ“ä½œ

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ç›‘å¬è´¨æŠ¼äº‹ä»¶
2. æ£€æŸ¥äº‹ä»¶å­—æ®µ

**é¢„æœŸç»“æœï¼š**
- sourceContract: å‘é€ç«¯åˆçº¦åœ°å€
- targetContract: æ¥æ”¶ç«¯åˆçº¦åœ°å€
- chainId: æ­£ç¡®çš„ chain id
- blockHeight: å½“å‰åŒºå—é«˜åº¦
- amount: 100
- receiverAddress: "target_address"
- nonce: å•è°ƒé€’å¢çš„å€¼ï¼ˆ64ä½æ— ç¬¦å·æ•´æ•°ï¼Œæº¢å‡ºæ—¶é‡ç½®ä¸º0ï¼‰

---

### æ¥æ”¶ç«¯åˆçº¦æµ‹è¯•

**æ³¨æ„ï¼š** æ¥æ”¶ç«¯åˆçº¦çš„åˆå§‹åŒ–å’Œå¯¹ç«¯é…ç½®å·²åˆå¹¶åˆ°ç»Ÿä¸€åˆçº¦çš„ `initialize` å’Œ `configure_peer` å‡½æ•°ä¸­ï¼Œä¸å†éœ€è¦å•ç‹¬çš„åˆå§‹åŒ–æµ‹è¯•ç”¨ä¾‹ã€‚

#### TC-101: æ·»åŠ  Relayer - ç®¡ç†å‘˜æƒé™

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç®¡ç†å‘˜å¯ä»¥æ·»åŠ  relayerï¼ˆåŒ…å«ECDSAå…¬é’¥ï¼‰

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–ï¼ˆé€šè¿‡ `initialize`ï¼‰
- ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·è°ƒç”¨
- å‡†å¤‡å¥½ relayer åœ°å€å’Œ ECDSA å…¬é’¥

**æµ‹è¯•æ­¥éª¤ï¼š**
1. è°ƒç”¨ `addRelayer(relayerAddress1, ecdsaPubkey1)`
2. è°ƒç”¨ `addRelayer(relayerAddress2, ecdsaPubkey2)`
3. è°ƒç”¨ `addRelayer(relayerAddress3, ecdsaPubkey3)`
4. æŸ¥è¯¢ relayer æ•°é‡

**é¢„æœŸç»“æœï¼š**
- ä¸‰ä¸ª relayer æ·»åŠ æˆåŠŸï¼ˆåŒ…å«ECDSAå…¬é’¥ï¼‰
- `getRelayerCount()` è¿”å› 3
- `isRelayer(relayerAddress1)` è¿”å› true
- ECDSAå…¬é’¥è¢«æ­£ç¡®å­˜å‚¨

**æµ‹è¯•æ•°æ®ï¼š**
- relayerAddress: Relayer åœ°å€
- ecdsaPubkey: ECDSAå…¬é’¥ï¼ˆ65å­—èŠ‚æœªå‹ç¼©æ ¼å¼ï¼‰

#### TC-102: ç§»é™¤ Relayer - ç®¡ç†å‘˜æƒé™

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç®¡ç†å‘˜å¯ä»¥ç§»é™¤ relayerï¼ˆåŒæ—¶ç§»é™¤ECDSAå…¬é’¥ï¼‰

**å‰ç½®æ¡ä»¶ï¼š**
- ç™½åå•ä¸­å·²æœ‰ relayer

**æµ‹è¯•æ­¥éª¤ï¼š**
1. è°ƒç”¨ `removeRelayer(relayerAddress1)`
2. æŸ¥è¯¢ relayer çŠ¶æ€

**é¢„æœŸç»“æœï¼š**
- relayer ç§»é™¤æˆåŠŸ
- å¯¹åº”çš„ ECDSA å…¬é’¥ä¹Ÿè¢«ç§»é™¤
- `isRelayer(relayerAddress1)` è¿”å› false
- `getRelayerCount()` å‡å°‘ 1

#### TC-103: æ·»åŠ /ç§»é™¤ Relayer - éç®¡ç†å‘˜æƒé™

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯éç®¡ç†å‘˜æ— æ³•æ·»åŠ æˆ–ç§»é™¤ relayer

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–
- ä½¿ç”¨éç®¡ç†å‘˜è´¦æˆ·è°ƒç”¨

**æµ‹è¯•æ­¥éª¤ï¼š**
1. éç®¡ç†å‘˜è°ƒç”¨ `addRelayer(relayerAddress)`
2. éç®¡ç†å‘˜è°ƒç”¨ `removeRelayer(relayerAddress)`

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å›æƒé™é”™è¯¯
- relayer æœªè¢«æ·»åŠ /ç§»é™¤

#### TC-104: æäº¤ç­¾å - å•ä¸ª Relayerï¼ˆæœªè¾¾åˆ°é˜ˆå€¼ï¼‰

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯å•ä¸ª relayer æäº¤ç­¾åï¼Œæœªè¾¾åˆ°é˜ˆå€¼æ—¶ä¸æ‰§è¡Œè§£é”

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- ç™½åå•ä¸­æœ‰ 3 ä¸ª relayer
- é‡‘åº“æœ‰è¶³å¤Ÿä½™é¢
- æœ‰æœ‰æ•ˆçš„è´¨æŠ¼äº‹ä»¶æ•°æ®ï¼ˆnonce > last_nonceï¼‰

**æµ‹è¯•æ­¥éª¤ï¼š**
1. relayer1 è°ƒç”¨ `submitSignature(eventData, signature1)`
2. æ£€æŸ¥åˆçº¦çŠ¶æ€
3. æ£€æŸ¥æ¥æ”¶åœ°å€ä½™é¢
4. æ£€æŸ¥ CrossChainRequest PDA è´¦æˆ·

**é¢„æœŸç»“æœï¼š**
- ç­¾åæäº¤æˆåŠŸ
- ç­¾åè¢«è®°å½•åˆ° CrossChainRequest PDA è´¦æˆ·
- æœªè¾¾åˆ°é˜ˆå€¼ï¼ˆ1 < 2ï¼‰ï¼Œä¸æ‰§è¡Œè§£é”
- æ¥æ”¶åœ°å€ä½™é¢ä¸å˜
- last_nonce æœªæ›´æ–°

#### TC-105: æäº¤ç­¾å - è¾¾åˆ°é˜ˆå€¼å¹¶è§£é”

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯è¾¾åˆ° 2/3 é˜ˆå€¼åæ‰§è¡Œè§£é”

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- ç™½åå•ä¸­æœ‰ 3 ä¸ª relayer
- é‡‘åº“æœ‰è¶³å¤Ÿä½™é¢
- æœ‰æœ‰æ•ˆçš„è´¨æŠ¼äº‹ä»¶æ•°æ®ï¼ˆnonce > last_nonceï¼‰

**æµ‹è¯•æ­¥éª¤ï¼š**
1. relayer1 æäº¤ç­¾å
2. relayer2 æäº¤ç­¾å
3. æ£€æŸ¥æ¥æ”¶åœ°å€ä½™é¢
4. æ£€æŸ¥ nonce çŠ¶æ€ï¼ˆlast_nonceï¼‰
5. æ£€æŸ¥ CrossChainRequest PDA è´¦æˆ·çŠ¶æ€

**é¢„æœŸç»“æœï¼š**
- 2 ä¸ªç­¾åè¾¾åˆ°é˜ˆå€¼ï¼ˆ2/3 * 3 = 2ï¼‰
- æ¥æ”¶åœ°å€æ”¶åˆ°ç­‰é‡ USDC
- é‡‘åº“ä½™é¢å‡å°‘ç›¸åº”æ•°é‡
- last_nonce è¢«æ›´æ–°ä¸º nonceï¼ˆæ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼‰
- CrossChainRequest PDA è´¦æˆ·æ ‡è®°ä¸ºå·²è§£é”ï¼ˆis_unlocked = trueï¼‰

#### TC-106: æäº¤ç­¾å - Nonceé€’å¢åˆ¤æ–­ï¼ˆé‡æ”¾æ”»å‡»é˜²å¾¡ï¼‰

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ nonce é€’å¢åˆ¤æ–­æœºåˆ¶é˜²æ­¢é‡æ”¾æ”»å‡»

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- ç™½åå•ä¸­æœ‰ 3 ä¸ª relayer
- æŸä¸ª nonce å·²è¢«ä½¿ç”¨ï¼ˆlast_nonce = nonce1ï¼‰

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ä½¿ç”¨ nonce <= last_nonce çš„äº‹ä»¶æ•°æ®æäº¤ç­¾å
2. æ£€æŸ¥äº¤æ˜“ç»“æœ

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å› nonce é€’å¢åˆ¤æ–­é”™è¯¯ï¼ˆnonce <= last_nonceï¼‰
- ä¸æ‰§è¡Œè§£é”æ“ä½œ
- last_nonce ä¸å˜

**æµ‹è¯•åœºæ™¯ï¼š**
- åœºæ™¯1ï¼šnonce = last_nonceï¼ˆç›¸åŒ nonceï¼‰
- åœºæ™¯2ï¼šnonce < last_nonceï¼ˆæ›´å°çš„ nonceï¼‰
- åœºæ™¯3ï¼šnonce > last_nonceï¼ˆæ­£å¸¸æƒ…å†µï¼Œåº”è¯¥æˆåŠŸï¼‰

#### TC-107: æäº¤ç­¾å - æ— æ•ˆç­¾å

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç­¾åéªŒè¯æœºåˆ¶

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- ç™½åå•ä¸­æœ‰ 3 ä¸ª relayer
- æœ‰æ•ˆçš„äº‹ä»¶æ•°æ®
- é”™è¯¯çš„ç­¾åï¼ˆé relayer ç§é’¥ç­¾åï¼‰

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æäº¤é”™è¯¯ç­¾å

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å›ç­¾åæ— æ•ˆé”™è¯¯
- ç­¾åæœªè¢«è®°å½•åˆ° CrossChainRequest PDA è´¦æˆ·

#### TC-108: æäº¤ç­¾å - éç™½åå• Relayer

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç™½åå•éªŒè¯æœºåˆ¶

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- è°ƒç”¨è€…ä¸åœ¨ç™½åå•ä¸­

**æµ‹è¯•æ­¥éª¤ï¼š**
1. éç™½åå•åœ°å€è°ƒç”¨ `submitSignature()`

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å›æƒé™é”™è¯¯
- ç­¾åæœªè¢«è®°å½•

#### TC-109: æäº¤ç­¾å - USDCåœ°å€æœªé…ç½®

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯USDCåœ°å€æœªé…ç½®æ—¶çš„é”™è¯¯å¤„ç†

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–
- USDCä»£å¸åœ°å€æœªé…ç½®ï¼ˆæœªè°ƒç”¨ `configure_usdc`ï¼‰
- ç™½åå•ä¸­æœ‰ relayer

**æµ‹è¯•æ­¥éª¤ï¼š**
1. Relayer è°ƒç”¨ `submitSignature(eventData, signature)`

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“å¤±è´¥ï¼Œè¿”å› "USDC address not configured" é”™è¯¯
- ç­¾åæœªè¢«è®°å½•
- ä¸æ‰§è¡Œè§£é”æ“ä½œ

#### TC-110: æäº¤ç­¾å - é”™è¯¯çš„æºé“¾åˆçº¦åœ°å€

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯æ¥æ”¶ç«¯åˆçº¦éªŒè¯æºé“¾åˆçº¦åœ°å€

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- æ¥æ”¶ç«¯åˆçº¦å·²é…ç½®æ­£ç¡®çš„æºé“¾åˆçº¦åœ°å€
- Relayer åœ¨ç™½åå•ä¸­

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æ„é€ åŒ…å«é”™è¯¯æºé“¾åˆçº¦åœ°å€çš„äº‹ä»¶æ•°æ®
2. Relayer æäº¤ç­¾å

**é¢„æœŸç»“æœï¼š**
- æ¥æ”¶ç«¯åˆçº¦æ£€æµ‹åˆ°åˆçº¦åœ°å€ä¸åŒ¹é…
- äº¤æ˜“å¤±è´¥æˆ–è¢«æ‹’ç»
- è®°å½•å®‰å…¨æ—¥å¿—

#### TC-111: æäº¤ç­¾å - é”™è¯¯çš„ Chain ID

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯æ¥æ”¶ç«¯åˆçº¦éªŒè¯ chain id

**å‰ç½®æ¡ä»¶ï¼š**
- åˆçº¦å·²åˆå§‹åŒ–å¹¶é…ç½®USDCå’Œå¯¹ç«¯
- æ¥æ”¶ç«¯åˆçº¦å·²é…ç½®æ­£ç¡®çš„ chain id
- Relayer åœ¨ç™½åå•ä¸­

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æ„é€ åŒ…å«é”™è¯¯ chain id çš„äº‹ä»¶æ•°æ®
2. Relayer æäº¤ç­¾å

**é¢„æœŸç»“æœï¼š**
- æ¥æ”¶ç«¯åˆçº¦æ£€æµ‹åˆ° chain id ä¸åŒ¹é…
- äº¤æ˜“å¤±è´¥æˆ–è¢«æ‹’ç»
- è®°å½•å®‰å…¨æ—¥å¿—

---

### Relayer æœåŠ¡æµ‹è¯•

#### TC-201: ç›‘å¬è´¨æŠ¼äº‹ä»¶

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ relayer èƒ½æ­£ç¡®ç›‘å¬äº‹ä»¶

**å‰ç½®æ¡ä»¶ï¼š**
- Relayer æœåŠ¡è¿è¡Œä¸­
- è¿æ¥åˆ°å‘é€ç«¯é“¾ RPC

**æµ‹è¯•æ­¥éª¤ï¼š**
1. åœ¨å‘é€ç«¯é“¾æ‰§è¡Œè´¨æŠ¼æ“ä½œ
2. è§‚å¯Ÿ relayer æ—¥å¿—

**é¢„æœŸç»“æœï¼š**
- Relayer æˆåŠŸæ•è· StakeEvent
- äº‹ä»¶æ•°æ®å®Œæ•´ä¸”æ­£ç¡®
- æ—¥å¿—è®°å½•äº‹ä»¶è¯¦æƒ…

#### TC-202: ç­¾åç”Ÿæˆ

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ relayer æ­£ç¡®ç”Ÿæˆç­¾å

**å‰ç½®æ¡ä»¶ï¼š**
- æ¥æ”¶åˆ°è´¨æŠ¼äº‹ä»¶

**æµ‹è¯•æ­¥éª¤ï¼š**
1. Relayer å¤„ç†äº‹ä»¶æ•°æ®
2. ç”Ÿæˆç­¾å
3. éªŒè¯ç­¾åæ ¼å¼

**é¢„æœŸç»“æœï¼š**
- ç­¾åæ ¼å¼æ­£ç¡®ï¼ˆECDSAï¼‰
- ç­¾åå¯ä»¥æ¢å¤å‡º relayer åœ°å€
- Hash è®¡ç®—æ­£ç¡®

#### TC-203: æäº¤ç­¾ååˆ°æ¥æ”¶ç«¯

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ relayer æ­£ç¡®æäº¤ç­¾å

**å‰ç½®æ¡ä»¶ï¼š**
- å·²ç”Ÿæˆæœ‰æ•ˆç­¾å
- æ¥æ”¶ç«¯åˆçº¦å¯è®¿é—®

**æµ‹è¯•æ­¥éª¤ï¼š**
1. Relayer è°ƒç”¨æ¥æ”¶ç«¯åˆçº¦
2. æäº¤äº‹ä»¶æ•°æ®å’Œç­¾å

**é¢„æœŸç»“æœï¼š**
- äº¤æ˜“æˆåŠŸæäº¤
- æ¥æ”¶ç«¯åˆçº¦æ¥å—ç­¾å
- è¿”å›æˆåŠŸçŠ¶æ€

#### TC-204: å¤š Relayer ååŒ

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯å¤šä¸ª relayer ååŒå·¥ä½œ

**å‰ç½®æ¡ä»¶ï¼š**
- 3 ä¸ª relayer æœåŠ¡è¿è¡Œä¸­
- éƒ½åœ¨ç™½åå•ä¸­

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æ‰§è¡Œè´¨æŠ¼æ“ä½œ
2. è§‚å¯Ÿ 3 ä¸ª relayer çš„è¡Œä¸º
3. æ£€æŸ¥æ¥æ”¶ç«¯ç»“æœ

**é¢„æœŸç»“æœï¼š**
- æ‰€æœ‰ relayer éƒ½ç›‘å¬åˆ°äº‹ä»¶
- æ‰€æœ‰ relayer éƒ½æäº¤ç­¾å
- å‰ 2 ä¸ªç­¾åè¾¾åˆ°é˜ˆå€¼åæ‰§è¡Œè§£é”
- ç¬¬ 3 ä¸ªç­¾åä»ç„¶è¢«æ¥å—ä½†ä¸å†è§¦å‘è§£é”

#### TC-205: Relayer æ•…éšœæ¢å¤

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ relayer æ•…éšœæƒ…å†µä¸‹ç³»ç»Ÿä»å¯å·¥ä½œ

**å‰ç½®æ¡ä»¶ï¼š**
- 3 ä¸ª relayerï¼Œ1 ä¸ªæ•…éšœ

**æµ‹è¯•æ­¥éª¤ï¼š**
1. åœæ­¢ 1 ä¸ª relayer
2. æ‰§è¡Œè´¨æŠ¼æ“ä½œ
3. è§‚å¯Ÿå‰©ä½™ 2 ä¸ª relayer

**é¢„æœŸç»“æœï¼š**
- 2 ä¸ª relayer æ­£å¸¸å·¥ä½œ
- ä»èƒ½è¾¾åˆ° 2/3 é˜ˆå€¼
- è§£é”æ“ä½œæ­£å¸¸æ‰§è¡Œ

#### TC-206: Relayer æ¶ˆæ¯éªŒè¯ - é”™è¯¯çš„åˆçº¦åœ°å€

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ relayer æ‹’ç»æ¥è‡ªé”™è¯¯åˆçº¦çš„äº‹ä»¶

**å‰ç½®æ¡ä»¶ï¼š**
- Relayer é…ç½®äº†æ­£ç¡®çš„å‘é€ç«¯åˆçº¦åœ°å€

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æ¨¡æ‹Ÿä¸€ä¸ªæ¥è‡ªé”™è¯¯åˆçº¦åœ°å€çš„è´¨æŠ¼äº‹ä»¶
2. è§‚å¯Ÿ relayer è¡Œä¸º

**é¢„æœŸç»“æœï¼š**
- Relayer æ£€æµ‹åˆ°åˆçº¦åœ°å€ä¸åŒ¹é…
- Relayer æ‹’ç»å¤„ç†è¯¥äº‹ä»¶
- ä¸å‘æ¥æ”¶ç«¯åˆçº¦æäº¤ç­¾å
- è®°å½•è­¦å‘Šæ—¥å¿—

#### TC-207: Relayer æ¶ˆæ¯éªŒè¯ - é”™è¯¯çš„ Chain ID

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ relayer æ‹’ç»é”™è¯¯ chain id çš„äº‹ä»¶

**å‰ç½®æ¡ä»¶ï¼š**
- Relayer é…ç½®äº†æ­£ç¡®çš„ chain id

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æ¨¡æ‹Ÿä¸€ä¸ªåŒ…å«é”™è¯¯ chain id çš„è´¨æŠ¼äº‹ä»¶
2. è§‚å¯Ÿ relayer è¡Œä¸º

**é¢„æœŸç»“æœï¼š**
- Relayer æ£€æµ‹åˆ° chain id ä¸åŒ¹é…
- Relayer æ‹’ç»å¤„ç†è¯¥äº‹ä»¶
- ä¸å‘æ¥æ”¶ç«¯åˆçº¦æäº¤ç­¾å
- è®°å½•è­¦å‘Šæ—¥å¿—

#### TC-208: Relayer æ¶ˆæ¯éªŒè¯ - é‡å¤çš„ Nonce

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ relayer æ£€æµ‹é‡å¤ nonce

**å‰ç½®æ¡ä»¶ï¼š**
- Relayer å·²å¤„ç†è¿‡æŸä¸ª nonce çš„äº‹ä»¶

**æµ‹è¯•æ­¥éª¤ï¼š**
1. å°è¯•ç”¨ç›¸åŒ nonce å†æ¬¡è§¦å‘äº‹ä»¶
2. è§‚å¯Ÿ relayer è¡Œä¸º

**é¢„æœŸç»“æœï¼š**
- Relayer æ£€æµ‹åˆ° nonce å·²è¢«å¤„ç†
- Relayer è·³è¿‡è¯¥äº‹ä»¶ï¼ˆæˆ–ä»ç„¶æäº¤ï¼Œç”±æ¥æ”¶ç«¯æ‹’ç»ï¼‰
- è®°å½•ä¿¡æ¯æ—¥å¿—

---

## é›†æˆæµ‹è¯•

### IT-001: ç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ï¼ˆEVM â†’ SVMï¼‰

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯å®Œæ•´çš„è·¨é“¾è½¬è´¦æµç¨‹

**æµ‹è¯•æ­¥éª¤ï¼š**
1. å‡†å¤‡æµ‹è¯•ç¯å¢ƒï¼ˆEVM å’Œ SVM åˆçº¦å·²éƒ¨ç½²ï¼‰
2. ç”¨æˆ·åœ¨ Arbitrum æ‰§è¡Œè´¨æŠ¼ 100 USDC
3. ç­‰å¾… relayer å¤„ç†
4. éªŒè¯ 1024chain ä¸Šæ¥æ”¶åœ°å€ä½™é¢

**é¢„æœŸç»“æœï¼š**
- æ•´ä¸ªæµç¨‹åœ¨åˆç†æ—¶é—´å†…å®Œæˆï¼ˆ< 5 åˆ†é’Ÿï¼‰
- æ¥æ”¶åœ°å€æ”¶åˆ° 100 USDC
- æ‰€æœ‰äº‹ä»¶å’Œäº¤æ˜“è®°å½•æ­£ç¡®

### IT-002: ç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ï¼ˆSVM â†’ EVMï¼‰

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯åå‘è·¨é“¾è½¬è´¦æµç¨‹

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ç”¨æˆ·åœ¨ 1024chain æ‰§è¡Œè´¨æŠ¼ 100 USDC
2. ç­‰å¾… relayer å¤„ç†
3. éªŒè¯ Arbitrum ä¸Šæ¥æ”¶åœ°å€ä½™é¢

**é¢„æœŸç»“æœï¼š**
- æ•´ä¸ªæµç¨‹æ­£å¸¸å®Œæˆ
- æ¥æ”¶åœ°å€æ”¶åˆ° 100 USDC

### IT-003: å¹¶å‘è·¨é“¾è½¬è´¦

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç³»ç»Ÿå¤„ç†å¹¶å‘è¯·æ±‚çš„èƒ½åŠ›

**æµ‹è¯•æ­¥éª¤ï¼š**
1. 10 ä¸ªç”¨æˆ·åŒæ—¶å‘èµ·è´¨æŠ¼è¯·æ±‚
2. è§‚å¯Ÿç³»ç»Ÿè¡Œä¸º
3. éªŒè¯æ‰€æœ‰è½¬è´¦ç»“æœ

**é¢„æœŸç»“æœï¼š**
- æ‰€æœ‰è¯·æ±‚éƒ½è¢«æ­£ç¡®å¤„ç†
- æ¯ä¸ªè¯·æ±‚çš„ nonce å”¯ä¸€
- æ‰€æœ‰æ¥æ”¶åœ°å€éƒ½æ”¶åˆ°æ­£ç¡®é‡‘é¢

### IT-004: å¤§é¢è½¬è´¦æµ‹è¯•

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç³»ç»Ÿå¤„ç†å¤§é¢è½¬è´¦çš„èƒ½åŠ›

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æ‰§è¡Œ 10,000 USDC çš„è´¨æŠ¼
2. éªŒè¯ç»“æœ

**é¢„æœŸç»“æœï¼š**
- è½¬è´¦æˆåŠŸå®Œæˆ
- é‡‘é¢ç²¾ç¡®åŒ¹é…

---

## å®‰å…¨æµ‹è¯•

### ST-001: Nonceé€’å¢åˆ¤æ–­æœºåˆ¶ï¼ˆé‡æ”¾æ”»å‡»é˜²å¾¡ï¼‰

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ nonce é€’å¢åˆ¤æ–­æœºåˆ¶é˜²å¾¡é‡æ”¾æ”»å‡»

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æ‰§è¡Œä¸€æ¬¡æˆåŠŸçš„è·¨é“¾è½¬è´¦ï¼ˆnonce = 1ï¼‰
2. éªŒè¯ last_nonce è¢«æ›´æ–°ä¸º 1
3. å°è¯•ä½¿ç”¨ç›¸åŒçš„ nonce (nonce = 1) é‡æ”¾äº‹ä»¶æ•°æ®å’Œç­¾å
4. å°è¯•ä½¿ç”¨æ›´å°çš„ nonce (nonce = 0) é‡æ”¾äº‹ä»¶æ•°æ®å’Œç­¾å
5. éªŒè¯ nonce æº¢å‡ºå¤„ç†ï¼ˆå½“ nonce è¾¾åˆ° u64::MAX æ—¶é‡ç½®ä¸º 0ï¼‰

**é¢„æœŸç»“æœï¼š**
- ç›¸åŒ nonce çš„é‡æ”¾è¢«æ‹’ç»ï¼ˆnonce <= last_nonceï¼‰
- æ›´å° nonce çš„é‡æ”¾è¢«æ‹’ç»ï¼ˆnonce < last_nonceï¼‰
- Nonce æº¢å‡ºæ—¶æ­£ç¡®å¤„ç†ï¼ˆå…è®¸ä» 0 å¼€å§‹ï¼‰
- ç³»ç»Ÿè®°å½•å®‰å…¨æ—¥å¿—

### ST-002: ç­¾åä¼ªé€ é˜²å¾¡

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç³»ç»Ÿé˜²å¾¡ç­¾åä¼ªé€ 

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ä½¿ç”¨é relayer ç§é’¥ç”Ÿæˆç­¾å
2. æäº¤åˆ°æ¥æ”¶ç«¯åˆçº¦

**é¢„æœŸç»“æœï¼š**
- ç­¾åéªŒè¯å¤±è´¥
- äº¤æ˜“è¢«æ‹’ç»

### ST-003: æƒé™æ§åˆ¶æµ‹è¯•

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç®¡ç†å‘˜æƒé™æ§åˆ¶

**æµ‹è¯•æ­¥éª¤ï¼š**
1. éç®¡ç†å‘˜å°è¯•æ·»åŠ  relayer
2. éç®¡ç†å‘˜å°è¯•ç§»é™¤ relayer

**é¢„æœŸç»“æœï¼š**
- æ‰€æœ‰æ“ä½œéƒ½è¢«æ‹’ç»
- è¿”å›æƒé™é”™è¯¯

### ST-004: é‡‘åº“å®‰å…¨æµ‹è¯•

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯é‡‘åº“èµ„é‡‘å®‰å…¨

**æµ‹è¯•æ­¥éª¤ï¼š**
1. å°è¯•ç›´æ¥ä»é‡‘åº“è½¬è´¦ï¼ˆç»•è¿‡åˆçº¦ï¼‰
2. å°è¯•è¶…é¢è§£é”

**é¢„æœŸç»“æœï¼š**
- ç›´æ¥è½¬è´¦å¤±è´¥ï¼ˆæƒé™æ§åˆ¶ï¼‰
- è¶…é¢è§£é”å¤±è´¥ï¼ˆä½™é¢æ£€æŸ¥ï¼‰

### ST-005: ä¼ªé€ äº‹ä»¶é˜²å¾¡å’ŒCrossChainRequest PDAå®‰å…¨

**æµ‹è¯•ç›®æ ‡ï¼š** éªŒè¯ç³»ç»Ÿé˜²å¾¡ä¼ªé€ äº‹ä»¶æ”»å‡»å’ŒCrossChainRequest PDAè´¦æˆ·å®‰å…¨

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æ„é€ ä¸€ä¸ªä¼ªé€ çš„è´¨æŠ¼äº‹ä»¶ï¼Œä½¿ç”¨é”™è¯¯çš„åˆçº¦åœ°å€
2. æ„é€ ä¸€ä¸ªä¼ªé€ çš„è´¨æŠ¼äº‹ä»¶ï¼Œä½¿ç”¨é”™è¯¯çš„ chain id
3. è§‚å¯Ÿ relayer å’Œæ¥æ”¶ç«¯åˆçº¦çš„è¡Œä¸º
4. éªŒè¯ CrossChainRequest PDA è´¦æˆ·çš„å®‰å…¨æ€§
5. éªŒè¯å¤šä¸ª relayer ä¸ºä¸åŒ nonce æäº¤ç­¾åçš„éš”ç¦»æ€§

**é¢„æœŸç»“æœï¼š**
- Relayer åœ¨éªŒè¯é˜¶æ®µæ‹’ç»å¤„ç†ä¼ªé€ äº‹ä»¶
- å³ä½¿ relayer ç»•è¿‡éªŒè¯ï¼Œæ¥æ”¶ç«¯åˆçº¦ä¹Ÿä¼šé€šè¿‡éªŒè¯åˆçº¦åœ°å€å’Œ chain id æ‹’ç»
- CrossChainRequest PDA è´¦æˆ·æ­£ç¡®éš”ç¦»ä¸åŒ nonce çš„ç­¾å
- æ¯ä¸ª nonce çš„ç­¾åç¼“å­˜ç‹¬ç«‹å­˜å‚¨ï¼Œäº’ä¸å½±å“
- ç³»ç»Ÿè®°å½•å®‰å…¨æ—¥å¿—

---

## æ€§èƒ½æµ‹è¯•

### PT-001: äº‹ä»¶ç›‘å¬å»¶è¿Ÿ

**æµ‹è¯•ç›®æ ‡ï¼š** æµ‹é‡äº‹ä»¶ç›‘å¬çš„å»¶è¿Ÿ

**æµ‹è¯•æ­¥éª¤ï¼š**
1. è®°å½•è´¨æŠ¼äº¤æ˜“ç¡®è®¤æ—¶é—´
2. è®°å½• relayer æ¥æ”¶äº‹ä»¶æ—¶é—´
3. è®¡ç®—å»¶è¿Ÿ

**æ€§èƒ½æŒ‡æ ‡ï¼š**
- ç›®æ ‡ï¼š< 30 ç§’

### PT-002: ç­¾åæäº¤å»¶è¿Ÿ

**æµ‹è¯•ç›®æ ‡ï¼š** æµ‹é‡ä»æ¥æ”¶äº‹ä»¶åˆ°æäº¤ç­¾åçš„æ—¶é—´

**æµ‹è¯•æ­¥éª¤ï¼š**
1. è®°å½• relayer æ¥æ”¶äº‹ä»¶æ—¶é—´
2. è®°å½•ç­¾åæäº¤äº¤æ˜“ç¡®è®¤æ—¶é—´
3. è®¡ç®—å»¶è¿Ÿ

**æ€§èƒ½æŒ‡æ ‡ï¼š**
- ç›®æ ‡ï¼š< 1 åˆ†é’Ÿ

### PT-003: ç«¯åˆ°ç«¯å»¶è¿Ÿ

**æµ‹è¯•ç›®æ ‡ï¼š** æµ‹é‡å®Œæ•´è·¨é“¾è½¬è´¦æ—¶é—´

**æµ‹è¯•æ­¥éª¤ï¼š**
1. è®°å½•è´¨æŠ¼äº¤æ˜“æ—¶é—´
2. è®°å½•è§£é”å®Œæˆæ—¶é—´
3. è®¡ç®—æ€»å»¶è¿Ÿ

**æ€§èƒ½æŒ‡æ ‡ï¼š**
- ç›®æ ‡ï¼š< 5 åˆ†é’Ÿ
- å¯æ¥å—ï¼š< 10 åˆ†é’Ÿ

### PT-004: ååé‡æµ‹è¯•

**æµ‹è¯•ç›®æ ‡ï¼š** æµ‹è¯•ç³»ç»Ÿæ¯å°æ—¶å¯å¤„ç†çš„è·¨é“¾è½¬è´¦æ•°é‡

**æµ‹è¯•æ­¥éª¤ï¼š**
1. æŒç»­ 1 å°æ—¶å‘é€è´¨æŠ¼è¯·æ±‚
2. ç»Ÿè®¡æˆåŠŸå¤„ç†çš„æ•°é‡

**æ€§èƒ½æŒ‡æ ‡ï¼š**
- ç›®æ ‡ï¼š> 100 ç¬”/å°æ—¶

---

## SVM æµ‹è¯•å®ç°è¯´æ˜

### æµ‹è¯•æ¡†æ¶å’Œå·¥å…·

**æµ‹è¯•æ¡†æ¶ï¼š**
- Anchor æµ‹è¯•æ¡†æ¶ï¼ˆåŸºäº Mocha å’Œ Chaiï¼‰
- TypeScript ç±»å‹æ”¯æŒ
- Solana Web3.js ç”¨äºä¸ Solana é“¾äº¤äº’

**å¯†ç å­¦åº“ï¼š**
- Node.js `crypto` æ¨¡å—
- ECDSA ç­¾åç®—æ³•ï¼ˆsecp256k1 æ›²çº¿ï¼‰
- SHA-256 å“ˆå¸Œç®—æ³•

### æµ‹è¯•ä»£ç ç»“æ„

**æ–‡ä»¶ä½ç½®ï¼š** `svm/bridge1024/tests/bridge1024.ts`

**ä¸»è¦æµ‹è¯•å¥—ä»¶ï¼š**
1. **Unified Contract Testsï¼ˆç»Ÿä¸€åˆçº¦æµ‹è¯•ï¼‰**
   - TC-001ï¼šç»Ÿä¸€åˆå§‹åŒ–ï¼ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯åŒæ—¶åˆå§‹åŒ–ï¼‰
   - TC-002ï¼šé…ç½®USDCä»£å¸åœ°å€
   - TC-003ï¼šç»Ÿä¸€å¯¹ç«¯é…ç½®ï¼ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯åŒæ—¶é…ç½®ï¼‰
   
2. **Sender Contract Testsï¼ˆå‘é€ç«¯åˆçº¦æµ‹è¯•ï¼‰**
   - TC-004 ~ TC-008ï¼šè´¨æŠ¼åŠŸèƒ½ã€USDCéªŒè¯ã€äº‹ä»¶å®Œæ•´æ€§æµ‹è¯•
   
3. **Receiver Contract Testsï¼ˆæ¥æ”¶ç«¯åˆçº¦æµ‹è¯•ï¼‰**
   - TC-101 ~ TC-103ï¼šRelayerç™½åå•ç®¡ç†ï¼ˆåŒ…å«ECDSAå…¬é’¥å­˜å‚¨ï¼‰
   - TC-104 ~ TC-111ï¼šç­¾åéªŒè¯ã€nonceé€’å¢åˆ¤æ–­ã€CrossChainRequest PDAæµ‹è¯•
   
4. **Integration Testsï¼ˆé›†æˆæµ‹è¯•ï¼‰**
   - IT-001 ~ IT-004ï¼šç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ã€å¹¶å‘è½¬è´¦ã€å¤§é¢è½¬è´¦æµ‹è¯•
   
5. **Security Testsï¼ˆå®‰å…¨æµ‹è¯•ï¼‰**
   - ST-001ï¼šNonceé€’å¢åˆ¤æ–­æœºåˆ¶ï¼ˆé‡æ”¾æ”»å‡»é˜²å¾¡ï¼‰
   - ST-002 ~ ST-005ï¼šç­¾åä¼ªé€ ã€æƒé™æ§åˆ¶ã€é‡‘åº“å®‰å…¨ã€CrossChainRequest PDAå®‰å…¨
   
6. **Performance Testsï¼ˆæ€§èƒ½æµ‹è¯•ï¼‰**
   - PT-001 ~ PT-004ï¼šäº‹ä»¶å»¶è¿Ÿã€ç­¾åéªŒè¯æ€§èƒ½ã€ååé‡æµ‹è¯•
   
7. **Cryptographic Helper Testsï¼ˆå¯†ç å­¦è¾…åŠ©æµ‹è¯•ï¼‰**
   - å“ˆå¸Œä¸€è‡´æ€§æµ‹è¯•
   - ECDSA ç­¾åç”Ÿæˆå’ŒéªŒè¯æµ‹è¯•
   - é˜ˆå€¼è®¡ç®—æµ‹è¯•

### å¯†ç å­¦å®ç°ç»†èŠ‚

#### ECDSA ç­¾åæµç¨‹

```typescript
// 1. ç”Ÿæˆ ECDSA å¯†é’¥å¯¹ï¼ˆsecp256k1 æ›²çº¿ï¼‰
function generateECDSAKeypair() {
  const ecdh = crypto.createECDH('secp256k1');
  ecdh.generateKeys();
  return {
    privateKey: ecdh.getPrivateKey(),
    publicKey: ecdh.getPublicKey()
  };
}

// 2. äº‹ä»¶æ•°æ®å“ˆå¸Œï¼ˆSHA-256ï¼‰
function hashEventData(eventData) {
  // åºåˆ—åŒ–äº‹ä»¶æ•°æ®
  const dataString = JSON.stringify({
    sourceContract, targetContract, chainId,
    blockHeight, amount, receiverAddress, nonce
  });
  // SHA-256 å“ˆå¸Œ
  return crypto.createHash('sha256').update(dataString).digest();
}

// 3. ç”Ÿæˆç­¾å
function generateSignature(eventData, privateKey) {
  const hash = hashEventData(eventData);
  const sign = crypto.createSign('SHA256');
  sign.update(hash);
  return sign.sign(privateKey);
}

// 4. éªŒè¯ç­¾å
function verifySignature(eventData, signature, publicKey) {
  const hash = hashEventData(eventData);
  const verify = crypto.createVerify('SHA256');
  verify.update(hash);
  return verify.verify(publicKey, signature);
}
```

#### Relayer ç™½åå•å’Œé˜ˆå€¼ç®¡ç†

- **é˜ˆå€¼è®¡ç®—ï¼š** `threshold = Math.ceil(relayerCount * 2 / 3)` ï¼ˆå½“ç­¾åæ•° >= é˜ˆå€¼æ—¶è§£é”ï¼‰
- **ç¤ºä¾‹ï¼š**
  - 3 ä¸ª Relayer â†’ é˜ˆå€¼ 2
  - 4 ä¸ª Relayer â†’ é˜ˆå€¼ 3
  - 5 ä¸ª Relayer â†’ é˜ˆå€¼ 4
  - 18 ä¸ª Relayer â†’ é˜ˆå€¼ 12

#### Nonce é€’å¢åˆ¤æ–­æœºåˆ¶

- **Nonce ç±»å‹ï¼š** 64 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu64ï¼‰
- **é€’å¢åˆ¤æ–­ï¼š** æ–° nonce å¿…é¡»å¤§äº `last_nonce`ï¼Œå¦åˆ™è§†ä¸ºé‡æ”¾æ”»å‡»
- **æº¢å‡ºå¤„ç†ï¼š** å½“ nonce è¾¾åˆ° `u64::MAX` (18,446,744,073,709,551,615) æ—¶ï¼Œé‡ç½®ä¸º 0
- **å®ç°é€»è¾‘ï¼š**
  ```rust
  if nonce <= receiver_state.last_nonce {
      return Err(Error::NonceReplayAttack);
  }
  // å¤„ç†ç­¾å...
  receiver_state.last_nonce = nonce;
  ```

#### CrossChainRequest PDA è´¦æˆ·

- **PDA ç§å­ï¼š** `[b"cross_chain_request", nonce.to_le_bytes()]`
- **è´¦æˆ·ç»“æ„ï¼š**
  ```rust
  pub struct CrossChainRequest {
      pub nonce: u64,
      pub signed_relayers: Vec<Pubkey>,
      pub signature_count: u8,
      pub is_unlocked: bool,
      pub event_data: StakeEventData,
  }
  ```
- **è®¾è®¡ä¼˜åŠ¿ï¼š**
  - æ”¯æŒè‡³å°‘ 100 ä¸ªæœªå®Œæˆçš„è¯·æ±‚åŒæ—¶å­˜åœ¨
  - æ”¯æŒè‡³å°‘ 1200 ä¸ªç­¾åç¼“å­˜ï¼ˆ100 ä¸ªè¯·æ±‚ Ã— 18 ä¸ª relayer = 1800 ä¸ªç­¾åï¼‰
  - æ¯ä¸ª nonce ç‹¬ç«‹è´¦æˆ·ï¼Œæ”¯æŒæ— é™ nonce
  - è§£é”åå¯ä»¥å…³é—­è´¦æˆ·å›æ”¶ç§Ÿé‡‘

### äº‹ä»¶æ•°æ®ç»“æ„

```typescript
interface StakeEventData {
  sourceContract: PublicKey;  // å‘é€ç«¯åˆçº¦åœ°å€
  targetContract: PublicKey;  // æ¥æ”¶ç«¯åˆçº¦åœ°å€
  chainId: BN;                // é“¾ ID
  blockHeight: BN;            // åŒºå—é«˜åº¦
  amount: BN;                 // è´¨æŠ¼æ•°é‡ï¼ˆUSDCï¼Œ6ä½å°æ•°ï¼‰
  receiverAddress: string;    // æ¥æ”¶åœ°å€
  nonce: BN;                  // é˜²é‡æ”¾åºå·ï¼ˆ64ä½æ— ç¬¦å·æ•´æ•°ï¼Œæº¢å‡ºæ—¶é‡ç½®ä¸º0ï¼‰
}
```

### ç»Ÿä¸€åˆå§‹åŒ–æµç¨‹

**SVM å¹³å°ï¼š**
1. åˆ›å»º Squad å¤šç­¾è´¦æˆ·ä½œä¸º adminï¼ˆå¤–éƒ¨å¤„ç†ï¼Œæµ‹è¯•ä¸­å¯ä»¥ä½¿ç”¨æ™®é€šKeypairæ¨¡æ‹Ÿï¼‰
2. æ´¾ç”Ÿ PDA é‡‘åº“åœ°å€ï¼ˆç§å­ï¼š`[b"vault"]`ï¼‰
3. è°ƒç”¨ `initialize()` åŒæ—¶åˆå§‹åŒ–å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆçº¦
   - vault: PDA é‡‘åº“åœ°å€
   - admin: å¤šç­¾é’±åŒ…åœ°å€ï¼ˆæµ‹è¯•ä¸­å¯ä»¥ä½¿ç”¨æ™®é€šKeypairï¼‰
4. è°ƒç”¨ `configure_usdc(usdcAddress)` é…ç½®USDCä»£å¸åœ°å€ï¼ˆå¿…é¡»åœ¨stakeå’Œsubmit_signatureä¹‹å‰é…ç½®ï¼‰
5. è°ƒç”¨ `configure_peer(peerContract, sourceChainId, targetChainId)` ç»Ÿä¸€é…ç½®å¯¹ç«¯åˆçº¦å’Œé“¾ID
6. ï¼ˆå¯é€‰ï¼‰è°ƒç”¨ `addLiquidity(amount)` å‘ PDA é‡‘åº“å¢åŠ æµåŠ¨æ€§

**EVM å¹³å°ï¼š**
1. è°ƒç”¨ `initialize(vaultAddress, adminAddress)` åˆå§‹åŒ–å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆçº¦
2. è°ƒç”¨ `configure_usdc(usdcAddress)` é…ç½®USDC ERC20åˆçº¦åœ°å€
3. è°ƒç”¨ `configure_peer(peerContract, sourceChainId, targetChainId)` ç»Ÿä¸€é…ç½®å¯¹ç«¯åˆçº¦å’Œé“¾ID

### æµ‹è¯•è´¦æˆ·é…ç½®

```typescript
// ç®¡ç†è´¦æˆ·
admin: Keypair           // å¤šç­¾é’±åŒ…åœ°å€ï¼ˆåˆçº¦å±‚é¢è§†ä¸ºæ™®é€šåœ°å€ï¼‰
vault: PublicKey         // PDAé‡‘åº“åœ°å€ï¼ˆç§å­ï¼š[b"vault"]ï¼‰
vaultTokenAccount: PublicKey  // PDAé‡‘åº“token accountï¼ˆç§å­ï¼š[b"vault_token", usdc_mint]ï¼‰

// ç”¨æˆ·è´¦æˆ·
user1, user2: Keypair    // æµ‹è¯•ç”¨æˆ·

// Relayer è´¦æˆ·
relayer1, relayer2, relayer3: Keypair  // ç™½åå• Relayer
nonRelayer: Keypair                    // éç™½åå•è´¦æˆ·

// å…¶ä»–
nonAdmin: Keypair        // éç®¡ç†å‘˜è´¦æˆ·

// Tokenè´¦æˆ·
user1TokenAccount: PublicKey  // ç”¨æˆ·1çš„USDC token account
adminTokenAccount: PublicKey  // å¤šç­¾é’±åŒ…çš„USDC token account
```

**é‡è¦è¯´æ˜ï¼š**
- **vault**: ä½¿ç”¨ PDAï¼Œç”±ç¨‹åºæ§åˆ¶ï¼Œæ”¯æŒè‡ªåŠ¨è½¬è´¦
- **admin**: å¤šç­¾é’±åŒ…åœ°å€ï¼ˆå¦‚ Squad å¤šç­¾ï¼‰ï¼Œåˆçº¦å±‚é¢åªéªŒè¯ç­¾åï¼Œä¸å…³å¿ƒå¤šç­¾é€»è¾‘
- **Tokenè´¦æˆ·**: ä½¿ç”¨å…³è”tokenè´¦æˆ·ï¼ˆATAï¼‰ï¼Œé€šè¿‡ `getAssociatedTokenAddress` è·å–

### æµ‹è¯•é…ç½®å‚æ•°

```typescript
SOURCE_CHAIN_ID = 421614;        // Arbitrum Sepolia
TARGET_CHAIN_ID = 91024;         // 1024chain testnetï¼ˆå¾…ç¡®è®¤ï¼‰
TEST_AMOUNT = 100_000000;        // 100 USDC (6 decimals)
AIRDROP_AMOUNT = 10 SOL;         // æµ‹è¯•è´¦æˆ·ç©ºæŠ•é‡‘é¢
MAX_RELAYERS = 18;               // æœ€å¤š18ä¸ªrelayer
MIN_THRESHOLD = 2;               // æœ€å°é˜ˆå€¼ï¼ˆ3ä¸ªrelayeræ—¶ï¼‰
MAX_THRESHOLD = 13;              // æœ€å¤§é˜ˆå€¼ï¼ˆ18ä¸ªrelayeræ—¶ï¼‰
MAX_UNFINISHED_REQUESTS = 100;   // æœ€å¤š100ä¸ªæœªå®Œæˆè¯·æ±‚
MAX_SIGNATURE_CACHE = 1200;      // æœ€å¤š1200ä¸ªç­¾åç¼“å­˜
```

### è¿è¡Œæµ‹è¯•

```bash
# å®‰è£…ä¾èµ–
cd svm/bridge1024
yarn install

# è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆå½“å‰éƒ½ä¼šè·³è¿‡ï¼‰
anchor test

# è¿è¡Œç‰¹å®šæµ‹è¯•
anchor test --skip-build -- --grep "TC-001"

# å–æ¶ˆè·³è¿‡æµ‹è¯•ï¼ˆå½“åˆçº¦å®ç°å®Œæˆåï¼‰
# åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ç§»é™¤ .skip æ ‡è®°
```

### ä¸‹ä¸€æ­¥å·¥ä½œ

1. **å®Œæˆ SVM æ¥æ”¶ç«¯åˆçº¦å®ç°**
   - å®ç°å®Œæ•´çš„ ECDSA ç­¾åéªŒè¯ï¼ˆè§£æ DER æ ¼å¼ï¼Œä½¿ç”¨ secp256k1_programï¼‰
   - å®ç°å¤šç­¾é˜ˆå€¼æ£€æŸ¥å’Œè§£é”åŠŸèƒ½
   - å®ç° CrossChainRequest PDA è´¦æˆ·çš„åˆ›å»ºå’Œç®¡ç†
   - å®ç°è§£é”åå…³é—­ CrossChainRequest PDA è´¦æˆ·å›æ”¶ç§Ÿé‡‘
   - é€æ­¥å–æ¶ˆæµ‹è¯•çš„ `.skip` æ ‡è®°
   - ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

2. **ä»£ç è¦†ç›–ç‡**
   - ç›®æ ‡ï¼š> 90% ä»£ç è¦†ç›–ç‡
   - ä½¿ç”¨ Anchor çš„è¦†ç›–ç‡å·¥å…·æ£€æŸ¥

3. **å®‰å…¨å®¡è®¡å‡†å¤‡**
   - å®Œå–„é”™è¯¯å¤„ç†
   - æ·»åŠ å®‰å…¨æ—¥å¿—
   - éªŒè¯ nonce é€’å¢åˆ¤æ–­æœºåˆ¶çš„å®‰å…¨æ€§
   - éªŒè¯ CrossChainRequest PDA è´¦æˆ·çš„å®‰å…¨æ€§
   - å‡†å¤‡å®¡è®¡æ–‡æ¡£

4. **æ€§èƒ½ä¼˜åŒ–**
   - ä¼˜åŒ– CrossChainRequest PDA è´¦æˆ·çš„åˆ›å»ºå’ŒæŸ¥è¯¢æ€§èƒ½
   - ä¼˜åŒ– nonce é€’å¢åˆ¤æ–­çš„æ€§èƒ½ï¼ˆO(1) æ“ä½œï¼‰
   - ä¼˜åŒ–å¤šç­¾é˜ˆå€¼æ£€æŸ¥çš„æ€§èƒ½

---

## EVM æµ‹è¯•å®ç°è¯´æ˜

### æµ‹è¯•æ¡†æ¶å’Œå·¥å…·

**æµ‹è¯•æ¡†æ¶ï¼š**
- Foundry (Forge) æµ‹è¯•æ¡†æ¶
- Solidity æµ‹è¯•åˆçº¦
- Hardhat å¯é€‰ï¼ˆç”¨äºæ›´å¤æ‚çš„é›†æˆæµ‹è¯•ï¼‰

**å¯†ç å­¦åº“ï¼š**
- Solidity å†…ç½® `ecrecover` å‡½æ•°ç”¨äº ECDSA ç­¾åéªŒè¯
- `keccak256` å“ˆå¸Œå‡½æ•°ç”¨äºäº‹ä»¶æ•°æ®å“ˆå¸Œ
- OpenZeppelin åº“ï¼ˆå¯é€‰ï¼Œç”¨äºæ ‡å‡†æ¥å£ï¼‰

**æµ‹è¯•å·¥å…·ï¼š**
- `forge test` - è¿è¡Œæµ‹è¯•
- `forge coverage` - ä»£ç è¦†ç›–ç‡
- `forge snapshot` - Gas å¿«ç…§
- `anvil` - æœ¬åœ°æµ‹è¯•èŠ‚ç‚¹

### æµ‹è¯•ä»£ç ç»“æ„

**æ–‡ä»¶ä½ç½®ï¼š** `evm/bridge1024/test/Bridge1024.t.sol`

**ä¸»è¦æµ‹è¯•å¥—ä»¶ï¼š**
1. **Unified Contract Testsï¼ˆç»Ÿä¸€åˆçº¦æµ‹è¯•ï¼‰**
   - TC-001ï¼šç»Ÿä¸€åˆå§‹åŒ–ï¼ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯åŒæ—¶åˆå§‹åŒ–ï¼‰
   - TC-002ï¼šé…ç½®USDCä»£å¸åœ°å€
   - TC-003ï¼šç»Ÿä¸€å¯¹ç«¯é…ç½®ï¼ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯åŒæ—¶é…ç½®ï¼‰
   - TC-003Bï¼šç»Ÿä¸€å¯¹ç«¯é…ç½® - éç®¡ç†å‘˜æƒé™
   
2. **Sender Contract Testsï¼ˆå‘é€ç«¯åˆçº¦æµ‹è¯•ï¼‰**
   - TC-004ï¼šè´¨æŠ¼åŠŸèƒ½ - æˆåŠŸåœºæ™¯
   - TC-005ï¼šè´¨æŠ¼åŠŸèƒ½ - ä½™é¢ä¸è¶³
   - TC-006ï¼šè´¨æŠ¼åŠŸèƒ½ - æœªæˆæƒ
   - TC-007ï¼šè´¨æŠ¼åŠŸèƒ½ - USDCåœ°å€æœªé…ç½®
   - TC-008ï¼šè´¨æŠ¼äº‹ä»¶å®Œæ•´æ€§
   
3. **Receiver Contract Testsï¼ˆæ¥æ”¶ç«¯åˆçº¦æµ‹è¯•ï¼‰**
   - TC-101ï¼šæ·»åŠ  Relayer - ç®¡ç†å‘˜æƒé™
   - TC-102ï¼šç§»é™¤ Relayer - ç®¡ç†å‘˜æƒé™
   - TC-103ï¼šæ·»åŠ /ç§»é™¤ Relayer - éç®¡ç†å‘˜æƒé™
   - TC-104ï¼šæäº¤ç­¾å - å•ä¸ª Relayerï¼ˆæœªè¾¾åˆ°é˜ˆå€¼ï¼‰
   - TC-105ï¼šæäº¤ç­¾å - è¾¾åˆ°é˜ˆå€¼å¹¶è§£é”
   - TC-106ï¼šæäº¤ç­¾å - Nonceé€’å¢åˆ¤æ–­ï¼ˆé‡æ”¾æ”»å‡»é˜²å¾¡ï¼‰
   - TC-107ï¼šæäº¤ç­¾å - æ— æ•ˆç­¾å
   - TC-108ï¼šæäº¤ç­¾å - éç™½åå• Relayer
   - TC-109ï¼šæäº¤ç­¾å - USDCåœ°å€æœªé…ç½®
   - TC-110ï¼šæäº¤ç­¾å - é”™è¯¯çš„æºé“¾åˆçº¦åœ°å€
   - TC-111ï¼šæäº¤ç­¾å - é”™è¯¯çš„ Chain ID
   
4. **Integration Testsï¼ˆé›†æˆæµ‹è¯•ï¼‰**
   - IT-001ï¼šç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ï¼ˆEVM â†’ SVMï¼‰
   - IT-002ï¼šç«¯åˆ°ç«¯è·¨é“¾è½¬è´¦ï¼ˆSVM â†’ EVMï¼‰
   - IT-003ï¼šå¹¶å‘è·¨é“¾è½¬è´¦
   - IT-004ï¼šå¤§é¢è½¬è´¦æµ‹è¯•
   
5. **Security Testsï¼ˆå®‰å…¨æµ‹è¯•ï¼‰**
   - ST-001ï¼šNonceé€’å¢åˆ¤æ–­æœºåˆ¶ï¼ˆé‡æ”¾æ”»å‡»é˜²å¾¡ï¼‰
   - ST-002ï¼šç­¾åä¼ªé€ é˜²å¾¡
   - ST-003ï¼šæƒé™æ§åˆ¶æµ‹è¯•
   - ST-004ï¼šé‡‘åº“å®‰å…¨æµ‹è¯•
   - ST-005ï¼šä¼ªé€ äº‹ä»¶é˜²å¾¡
   
6. **Performance Testsï¼ˆæ€§èƒ½æµ‹è¯•ï¼‰**
   - PT-001ï¼šäº‹ä»¶ç›‘å¬å»¶è¿Ÿ
   - PT-002ï¼šç­¾åæäº¤å»¶è¿Ÿ
   - PT-003ï¼šç«¯åˆ°ç«¯å»¶è¿Ÿ
   - PT-004ï¼šååé‡æµ‹è¯•

### å¯†ç å­¦å®ç°ç»†èŠ‚

#### ECDSA ç­¾åæµç¨‹

```solidity
// 1. äº‹ä»¶æ•°æ®å“ˆå¸Œï¼ˆkeccak256ï¼‰
function hashEventData(StakeEventData memory eventData) internal pure returns (bytes32) {
    return keccak256(abi.encodePacked(
        eventData.sourceContract,
        eventData.targetContract,
        eventData.chainId,
        eventData.blockHeight,
        eventData.amount,
        eventData.receiverAddress,
        eventData.nonce
    ));
}

// 2. ç”Ÿæˆç­¾åï¼ˆåœ¨æµ‹è¯•ä¸­ä½¿ç”¨ ethers.js æˆ– foundry çš„ vm.signï¼‰
// åœ¨æµ‹è¯•ä¸­ï¼Œä½¿ç”¨ ethers.js:
// const hash = hashEventData(eventData);
// const signature = await relayer.signMessage(ethers.utils.arrayify(hash));

// 3. éªŒè¯ç­¾åï¼ˆåœ¨åˆçº¦ä¸­ä½¿ç”¨ ecrecoverï¼‰
function verifySignature(
    bytes32 hash,
    bytes memory signature,
    address expectedSigner
) internal pure returns (bool) {
    require(signature.length == 65, "Invalid signature length");
    
    bytes32 r;
    bytes32 s;
    uint8 v;
    
    assembly {
        r := mload(add(signature, 32))
        s := mload(add(signature, 64))
        v := byte(0, mload(add(signature, 96)))
    }
    
    if (v < 27) {
        v += 27;
    }
    
    require(v == 27 || v == 28, "Invalid signature v value");
    
    address recovered = ecrecover(hash, v, r, s);
    return recovered != address(0) && recovered == expectedSigner;
}
```

#### Relayer ç™½åå•å’Œé˜ˆå€¼ç®¡ç†

- **é˜ˆå€¼è®¡ç®—ï¼š** `threshold = Math.ceil(relayerCount * 2 / 3)` ï¼ˆå½“ç­¾åæ•° >= é˜ˆå€¼æ—¶è§£é”ï¼‰
- **ç¤ºä¾‹ï¼š**
  - 3 ä¸ª Relayer â†’ é˜ˆå€¼ 2
  - 4 ä¸ª Relayer â†’ é˜ˆå€¼ 3
  - 5 ä¸ª Relayer â†’ é˜ˆå€¼ 4
  - 18 ä¸ª Relayer â†’ é˜ˆå€¼ 12

#### Nonce é€’å¢åˆ¤æ–­æœºåˆ¶

- **Nonce ç±»å‹ï¼š** 64 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆuint64ï¼‰
- **é€’å¢åˆ¤æ–­ï¼š** æ–° nonce å¿…é¡»å¤§äº `lastNonce`ï¼Œå¦åˆ™è§†ä¸ºé‡æ”¾æ”»å‡»
- **æº¢å‡ºå¤„ç†ï¼š** å½“ nonce è¾¾åˆ° `type(uint64).max` (18,446,744,073,709,551,615) æ—¶ï¼Œé‡ç½®ä¸º 0
- **å®ç°é€»è¾‘ï¼š**
  ```solidity
  require(nonce > lastNonce, "Nonce must be greater than last nonce");
  // å¤„ç†ç­¾å...
  lastNonce = nonce;
  ```

#### å­˜å‚¨è®¾è®¡

EVM åˆçº¦ä½¿ç”¨ mapping å­˜å‚¨ï¼Œæ— å¤§å°é™åˆ¶ï¼š

```solidity
struct NonceSignature {
    mapping(address => bool) signedRelayers;
    uint8 signatureCount;
    bool isUnlocked;
    StakeEventData eventData;
}

mapping(uint256 => NonceSignature) public nonceSignatures;
mapping(uint256 => bool) public usedNonces;  // å¯é€‰ï¼Œç”¨äºé¢å¤–éªŒè¯
```

**è®¾è®¡ä¼˜åŠ¿ï¼š**
- æ”¯æŒç†è®ºä¸Šæ— é™ä¸ªæœªå®Œæˆçš„è¯·æ±‚
- æ”¯æŒæ— é™ä¸ªç­¾åç¼“å­˜
- æ¯ä¸ª nonce ç‹¬ç«‹å­˜å‚¨ï¼Œæ”¯æŒå¹¶å‘å¤„ç†
- ä½¿ç”¨ mappingï¼ŒæŸ¥è¯¢å’Œæ›´æ–°éƒ½æ˜¯ O(1) æ“ä½œ

### äº‹ä»¶æ•°æ®ç»“æ„

```solidity
struct StakeEventData {
    address sourceContract;    // å‘é€ç«¯åˆçº¦åœ°å€
    address targetContract;    // æ¥æ”¶ç«¯åˆçº¦åœ°å€
    uint256 chainId;           // é“¾ ID
    uint256 blockHeight;       // åŒºå—é«˜åº¦
    uint256 amount;            // è´¨æŠ¼æ•°é‡ï¼ˆUSDCï¼Œ6ä½å°æ•°ï¼‰
    string receiverAddress;    // æ¥æ”¶åœ°å€
    uint64 nonce;              // é˜²é‡æ”¾åºå·ï¼ˆ64ä½æ— ç¬¦å·æ•´æ•°ï¼Œæº¢å‡ºæ—¶é‡ç½®ä¸º0ï¼‰
}

event StakeEvent(
    address indexed sourceContract,
    address indexed targetContract,
    uint256 chainId,
    uint256 blockHeight,
    uint256 amount,
    string receiverAddress,
    uint64 nonce
);
```

### ç»Ÿä¸€åˆå§‹åŒ–æµç¨‹

**EVM å¹³å°ï¼š**
1. è°ƒç”¨ `initialize(vaultAddress, adminAddress)` åˆå§‹åŒ–å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆçº¦
2. è°ƒç”¨ `configure_usdc(usdcAddress)` é…ç½®USDC ERC20åˆçº¦åœ°å€ï¼ˆå¿…é¡»åœ¨stakeå’Œsubmit_signatureä¹‹å‰é…ç½®ï¼‰
3. è°ƒç”¨ `configure_peer(peerContract, sourceChainId, targetChainId)` ç»Ÿä¸€é…ç½®å¯¹ç«¯åˆçº¦å’Œé“¾ID

### æµ‹è¯•è´¦æˆ·é…ç½®

```solidity
// ç®¡ç†è´¦æˆ·
address admin;           // ç®¡ç†å‘˜è´¦æˆ·ï¼ˆå¯ä»¥æ˜¯ Gnosis Safe å¤šç­¾é’±åŒ…ï¼‰
address vault;           // é‡‘åº“è´¦æˆ·ï¼ˆå¯ä»¥æ˜¯ Gnosis Safe å¤šç­¾é’±åŒ…ï¼‰

// ç”¨æˆ·è´¦æˆ·
address user1;           // æµ‹è¯•ç”¨æˆ·1
address user2;           // æµ‹è¯•ç”¨æˆ·2

// Relayer è´¦æˆ·
address relayer1;        // ç™½åå• Relayer 1
address relayer2;        // ç™½åå• Relayer 2
address relayer3;        // ç™½åå• Relayer 3
address nonRelayer;      // éç™½åå•è´¦æˆ·

// å…¶ä»–
address nonAdmin;        // éç®¡ç†å‘˜è´¦æˆ·
```

**å¤šç­¾é’±åŒ…æµ‹è¯•è¯´æ˜ï¼š**
- `admin` å’Œ `vault` å¯ä»¥æ˜¯ Gnosis Safe å¤šç­¾é’±åŒ…åœ°å€
- åœ¨æµ‹è¯•ä¸­ï¼Œå¦‚æœä½¿ç”¨ Gnosis Safe ä½œä¸º vaultï¼Œéœ€è¦å…ˆæ‰§è¡Œ `usdc.approve(bridgeContract, type(uint256).max)` æˆæƒåˆçº¦
- æµ‹è¯•æ—¶å¯ä»¥ä½¿ç”¨æ™®é€š EOA åœ°å€æˆ–å¤šç­¾é’±åŒ…åœ°å€ï¼Œä¸¤è€…åœ¨åˆçº¦å±‚é¢æ²¡æœ‰åŒºåˆ«

### æµ‹è¯•é…ç½®å‚æ•°

```solidity
uint256 constant SOURCE_CHAIN_ID = 421614;        // Arbitrum Sepolia
uint256 constant TARGET_CHAIN_ID = 91024;         // 1024chain testnetï¼ˆå¾…ç¡®è®¤ï¼‰
uint256 constant TEST_AMOUNT = 100 * 10**6;       // 100 USDC (6 decimals)
uint256 constant MAX_RELAYERS = 18;               // æœ€å¤š18ä¸ªrelayer
uint8 constant MIN_THRESHOLD = 2;                 // æœ€å°é˜ˆå€¼ï¼ˆ3ä¸ªrelayeræ—¶ï¼‰
uint8 constant MAX_THRESHOLD = 13;               // æœ€å¤§é˜ˆå€¼ï¼ˆ18ä¸ªrelayeræ—¶ï¼‰
```

### USDC Mock ä»£å¸

åœ¨æµ‹è¯•ä¸­éœ€è¦éƒ¨ç½²ä¸€ä¸ª Mock USDC ä»£å¸åˆçº¦ï¼š

```solidity
contract MockUSDC is ERC20 {
    constructor() ERC20("USD Coin", "USDC") {
        _mint(msg.sender, 1000000 * 10**6); // é“¸é€ 100ä¸‡USDCç”¨äºæµ‹è¯•
    }
    
    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }
}
```

### æµ‹è¯•è¾…åŠ©å‡½æ•°

```solidity
// ç”Ÿæˆäº‹ä»¶æ•°æ®å“ˆå¸Œ
function hashEventData(StakeEventData memory eventData) internal pure returns (bytes32) {
    return keccak256(abi.encodePacked(
        eventData.sourceContract,
        eventData.targetContract,
        eventData.chainId,
        eventData.blockHeight,
        eventData.amount,
        eventData.receiverAddress,
        eventData.nonce
    ));
}

// ç”Ÿæˆç­¾åï¼ˆåœ¨æµ‹è¯•ä¸­ä½¿ç”¨ foundry çš„ vm.signï¼‰
function signEventData(
    StakeEventData memory eventData,
    uint256 privateKey
) internal pure returns (bytes memory) {
    bytes32 hash = hashEventData(eventData);
    // ä½¿ç”¨ foundry çš„ vm.sign æˆ– ethers.js çš„ signMessage
    // è¿™é‡Œéœ€è¦åœ¨æµ‹è¯•åˆçº¦ä¸­ä½¿ç”¨ vm.sign
    return abi.encodePacked(r, s, v);
}

// éªŒè¯é˜ˆå€¼
function calculateThreshold(uint256 relayerCount) internal pure returns (uint256) {
    return (relayerCount * 2 + 2) / 3; // å‘ä¸Šå–æ•´
}

// è®¾ç½® ERC20 æˆæƒï¼ˆç”¨äºå¤šç­¾é’±åŒ…æµ‹è¯•ï¼‰
function setupApproval(address token, address spender, address owner, uint256 amount) internal {
    vm.prank(owner);
    IERC20(token).approve(spender, amount);
}

// è®¾ç½®æ— é™æˆæƒï¼ˆç”¨äºå¤šç­¾é’±åŒ…æµ‹è¯•ï¼‰
function setupInfiniteApproval(address token, address spender, address owner) internal {
    setupApproval(token, spender, owner, type(uint256).max);
}
```

**å¤šç­¾é’±åŒ…æµ‹è¯•æ³¨æ„äº‹é¡¹ï¼š**
- å¦‚æœä½¿ç”¨ Gnosis Safe ä½œä¸º vaultï¼Œåœ¨æµ‹è¯• setUp ä¸­éœ€è¦å…ˆæ‰§è¡Œ `setupInfiniteApproval(usdc, bridgeContract, vault)`
- å¦‚æœä½¿ç”¨ Gnosis Safe ä½œä¸º adminï¼Œç®¡ç†æ“ä½œéœ€è¦é€šè¿‡ Safe çš„å¤šç­¾æŠ•ç¥¨æµç¨‹
- åœ¨æµ‹è¯•ä¸­å¯ä»¥ä½¿ç”¨ `vm.prank` æ¨¡æ‹Ÿå¤šç­¾é’±åŒ…åœ°å€è°ƒç”¨åˆçº¦

### è¿è¡Œæµ‹è¯•

```bash
# å®‰è£…ä¾èµ–ï¼ˆå¦‚æœä½¿ç”¨ foundryï¼‰
cd evm/bridge1024
forge install

# ç¼–è¯‘åˆçº¦
forge build

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
forge test

# è¿è¡Œç‰¹å®šæµ‹è¯•
forge test --match-test testTC001

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
forge test -vvv

# ç”Ÿæˆä»£ç è¦†ç›–ç‡æŠ¥å‘Š
forge coverage

# ç”Ÿæˆ Gas å¿«ç…§
forge snapshot

# ä½¿ç”¨æœ¬åœ°èŠ‚ç‚¹ï¼ˆanvilï¼‰
anvil
forge test --fork-url http://localhost:8545
```

### æµ‹è¯•æœ€ä½³å®è·µ

1. **ä½¿ç”¨ Foundry çš„ä½œå¼Šç ï¼ˆCheatcodesï¼‰**
   - `vm.startPrank(address)` - æ¨¡æ‹Ÿäº¤æ˜“å‘é€è€…
   - `vm.deal(address, amount)` - ç»™åœ°å€å‘é€ ETH
   - `vm.expectRevert()` - æœŸæœ›äº¤æ˜“å›æ»š
   - `vm.expectEmit()` - éªŒè¯äº‹ä»¶å‘å‡º
   - `vm.sign(privateKey, hash)` - ç”Ÿæˆç­¾å

2. **æµ‹è¯•éš”ç¦»**
   - æ¯ä¸ªæµ‹è¯•å‡½æ•°åº”è¯¥ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•çš„çŠ¶æ€
   - ä½¿ç”¨ `setUp()` å‡½æ•°åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ

3. **Gas ä¼˜åŒ–æµ‹è¯•**
   - ä½¿ç”¨ `forge snapshot` è·Ÿè¸ª Gas ä½¿ç”¨
   - ç¡®ä¿å…³é”®æ“ä½œçš„ Gas æ¶ˆè€—åœ¨åˆç†èŒƒå›´å†…

4. **è¾¹ç•Œæ¡ä»¶æµ‹è¯•**
   - æµ‹è¯• nonce æº¢å‡ºæƒ…å†µ
   - æµ‹è¯•æœ€å¤§ relayer æ•°é‡ï¼ˆ18ä¸ªï¼‰
   - æµ‹è¯•å¤§é¢è½¬è´¦ï¼ˆæ¥è¿‘ uint256 æœ€å¤§å€¼ï¼‰

5. **å®‰å…¨æµ‹è¯•**
   - æµ‹è¯•é‡æ”¾æ”»å‡»é˜²å¾¡
   - æµ‹è¯•ç­¾åä¼ªé€ é˜²å¾¡
   - æµ‹è¯•æƒé™æ§åˆ¶
   - æµ‹è¯•é‡‘åº“å®‰å…¨

### ä¸‹ä¸€æ­¥å·¥ä½œ

1. **å®Œæˆ EVM åˆçº¦å®ç°**
   - å®ç°ç»Ÿä¸€åˆå§‹åŒ–å‡½æ•°ï¼ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼‰
   - å®ç° USDC é…ç½®å‡½æ•°
   - å®ç°ç»Ÿä¸€å¯¹ç«¯é…ç½®å‡½æ•°
   - å®ç°å‘é€ç«¯è´¨æŠ¼åŠŸèƒ½
   - å®ç°æ¥æ”¶ç«¯ç­¾åéªŒè¯å’Œè§£é”åŠŸèƒ½
   - å®ç° Relayer ç™½åå•ç®¡ç†
   - å®ç° nonce é€’å¢åˆ¤æ–­æœºåˆ¶

2. **å®ç°æµ‹è¯•ç”¨ä¾‹**
   - æŒ‰ç…§æµ‹è¯•è®¡åˆ’å®ç°æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹
   - ä½¿ç”¨ TDD æ–¹æ³•ï¼Œå…ˆå†™æµ‹è¯•å†å®ç°åŠŸèƒ½
   - ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

3. **ä»£ç è¦†ç›–ç‡**
   - ç›®æ ‡ï¼š> 90% ä»£ç è¦†ç›–ç‡
   - ä½¿ç”¨ `forge coverage` æ£€æŸ¥è¦†ç›–ç‡

4. **å®‰å…¨å®¡è®¡å‡†å¤‡**
   - å®Œå–„é”™è¯¯å¤„ç†
   - æ·»åŠ äº‹ä»¶æ—¥å¿—
   - éªŒè¯ nonce é€’å¢åˆ¤æ–­æœºåˆ¶çš„å®‰å…¨æ€§
   - éªŒè¯ç­¾åéªŒè¯çš„å®‰å…¨æ€§
   - å‡†å¤‡å®¡è®¡æ–‡æ¡£

5. **æ€§èƒ½ä¼˜åŒ–**
   - ä¼˜åŒ– Gas æ¶ˆè€—
   - ä¼˜åŒ–å­˜å‚¨å¸ƒå±€
   - ä¼˜åŒ–äº‹ä»¶æ•°æ®ç»“æ„

